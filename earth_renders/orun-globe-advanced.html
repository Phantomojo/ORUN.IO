<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORUN Globe - Advanced</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #00ff00;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            font-size: 14px;
        }
        
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #00ff00;
            font-size: 18px;
            z-index: 1000;
        }
        
        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: #00ff00;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .controls button {
            background: #333;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 8px 16px;
            margin: 4px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .controls button:hover {
            background: #00ff00;
            color: #000;
        }
        
        .controls select {
            background: #333;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 8px;
            margin: 4px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="loading">Loading ORUN Globe - Advanced...</div>
        <div id="info" style="display: none;">
            <h3>ORUN GLOBE - ADVANCED</h3>
            <p>High-quality textures & atmospheric effects</p>
            <p>FPS: <span id="fps">0</span></p>
            <p>Mode: <span id="mode">Realistic</span></p>
        </div>
        <div class="controls" style="display: none;">
            <button onclick="toggleMode()">Toggle Mode</button>
            <button onclick="toggleAtmosphere()">Toggle Atmosphere</button>
            <button onclick="toggleClouds()">Toggle Clouds</button>
            <button onclick="resetCamera()">Reset Camera</button>
            <select onchange="changeQuality(this.value)">
                <option value="low">Low Quality</option>
                <option value="medium" selected>Medium Quality</option>
                <option value="high">High Quality</option>
            </select>
        </div>
    </div>

    <!-- Three.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        // Global variables
        let scene, camera, renderer, controls;
        let earth, atmosphere, clouds, nightLights;
        let isRealisticMode = true;
        let atmosphereVisible = true;
        let cloudsVisible = true;
        let quality = 'medium';
        let stats = { fps: 0 };
        
        // Quality settings
        const qualitySettings = {
            low: { segments: 32, textureSize: 512 },
            medium: { segments: 64, textureSize: 1024 },
            high: { segments: 128, textureSize: 2048 }
        };
        
        // Initialize the application
        function init() {
            console.log('Initializing ORUN Globe - Advanced...');
            
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000011); // Deep space blue
            
            // Create camera
            camera = new THREE.PerspectiveCamera(
                60, 
                window.innerWidth / window.innerHeight, 
                0.1, 
                1000
            );
            camera.position.set(0, 0, 15);
            
            // Create renderer
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2;
            document.getElementById('container').appendChild(renderer.domElement);
            
            // Create controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.autoRotate = true;
            controls.autoRotateSpeed = 0.3;
            controls.minDistance = 8;
            controls.maxDistance = 50;
            controls.minPolarAngle = 0.1;
            controls.maxPolarAngle = Math.PI - 0.1;
            
            // Add lighting
            setupLighting();
            
            // Create Earth
            createEarth();
            
            // Create atmosphere
            createAtmosphere();
            
            // Create clouds
            createClouds();
            
            // Create night lights
            createNightLights();
            
            // Handle window resize
            window.addEventListener('resize', onWindowResize, false);
            
            // Start animation loop
            animate();
            
            // Hide loading and show UI
            document.getElementById('loading').style.display = 'none';
            document.getElementById('info').style.display = 'block';
            document.querySelector('.controls').style.display = 'block';
            
            console.log('ORUN Globe - Advanced initialized successfully!');
        }
        
        function setupLighting() {
            // Ambient light
            const ambientLight = new THREE.AmbientLight(0x404040, 0.2);
            scene.add(ambientLight);
            
            // Directional light (sun)
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1.5);
            directionalLight.position.set(5, 3, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            directionalLight.shadow.camera.near = 0.1;
            directionalLight.shadow.camera.far = 50;
            directionalLight.shadow.camera.left = -10;
            directionalLight.shadow.camera.right = 10;
            directionalLight.shadow.camera.top = 10;
            directionalLight.shadow.camera.bottom = -10;
            scene.add(directionalLight);
            
            // Point light for additional illumination
            const pointLight = new THREE.PointLight(0xffffff, 0.5, 100);
            pointLight.position.set(-5, 0, 5);
            scene.add(pointLight);
        }
        
        function createEarth() {
            const settings = qualitySettings[quality];
            
            // Create Earth geometry
            const geometry = new THREE.SphereGeometry(5, settings.segments, settings.segments);
            
            // Create high-quality Earth texture
            const earthTexture = createEarthTexture(settings.textureSize);
            const normalTexture = createNormalTexture(settings.textureSize);
            const specularTexture = createSpecularTexture(settings.textureSize);
            
            // Create Earth material with PBR properties
            const material = new THREE.MeshPhongMaterial({
                map: earthTexture,
                normalMap: normalTexture,
                specularMap: specularTexture,
                shininess: 100,
                transparent: false
            });
            
            // Create Earth mesh
            earth = new THREE.Mesh(geometry, material);
            earth.castShadow = true;
            earth.receiveShadow = true;
            scene.add(earth);
            
            console.log('Earth created with', settings.segments, 'segments and', settings.textureSize, 'texture size');
        }
        
        function createEarthTexture(size) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size / 2;
            const ctx = canvas.getContext('2d');
            
            // Create a more realistic Earth texture
            const gradient = ctx.createLinearGradient(0, 0, 0, size / 2);
            gradient.addColorStop(0, '#0f172a'); // Deep space
            gradient.addColorStop(0.2, '#1e3a8a'); // Deep ocean
            gradient.addColorStop(0.4, '#3b82f6'); // Ocean
            gradient.addColorStop(0.6, '#10b981'); // Land
            gradient.addColorStop(0.8, '#059669'); // Forest
            gradient.addColorStop(1, '#0f172a'); // Deep space
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, size, size / 2);
            
            // Add realistic land masses
            ctx.fillStyle = '#059669';
            
            // North America
            ctx.beginPath();
            ctx.ellipse(size * 0.2, size * 0.15, size * 0.08, size * 0.04, 0, 0, 2 * Math.PI);
            ctx.fill();
            
            // Europe/Africa
            ctx.beginPath();
            ctx.ellipse(size * 0.5, size * 0.25, size * 0.06, size * 0.08, 0, 0, 2 * Math.PI);
            ctx.fill();
            
            // Asia
            ctx.beginPath();
            ctx.ellipse(size * 0.8, size * 0.2, size * 0.1, size * 0.05, 0, 0, 2 * Math.PI);
            ctx.fill();
            
            // Australia
            ctx.beginPath();
            ctx.ellipse(size * 0.7, size * 0.4, size * 0.04, size * 0.02, 0, 0, 2 * Math.PI);
            ctx.fill();
            
            // South America
            ctx.beginPath();
            ctx.ellipse(size * 0.3, size * 0.35, size * 0.05, size * 0.08, 0, 0, 2 * Math.PI);
            ctx.fill();
            
            return new THREE.CanvasTexture(canvas);
        }
        
        function createNormalTexture(size) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size / 2;
            const ctx = canvas.getContext('2d');
            
            // Create a simple normal map
            const imageData = ctx.createImageData(size, size / 2);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                data[i] = 128;     // R
                data[i + 1] = 128; // G
                data[i + 2] = 255; // B
                data[i + 3] = 255; // A
            }
            
            ctx.putImageData(imageData, 0, 0);
            return new THREE.CanvasTexture(canvas);
        }
        
        function createSpecularTexture(size) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size / 2;
            const ctx = canvas.getContext('2d');
            
            // Create specular map (water areas are shiny)
            const gradient = ctx.createLinearGradient(0, 0, 0, size / 2);
            gradient.addColorStop(0, '#000000'); // Space - no specular
            gradient.addColorStop(0.2, '#ffffff'); // Ocean - high specular
            gradient.addColorStop(0.4, '#ffffff'); // Ocean - high specular
            gradient.addColorStop(0.6, '#404040'); // Land - low specular
            gradient.addColorStop(0.8, '#202020'); // Forest - very low specular
            gradient.addColorStop(1, '#000000'); // Space - no specular
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, size, size / 2);
            
            return new THREE.CanvasTexture(canvas);
        }
        
        function createAtmosphere() {
            // Create atmosphere geometry (slightly larger than Earth)
            const geometry = new THREE.SphereGeometry(5.1, 32, 32);
            
            // Create atmosphere material with custom shader-like effect
            const material = new THREE.MeshBasicMaterial({
                color: 0x87ceeb,
                transparent: true,
                opacity: 0.15,
                side: THREE.BackSide
            });
            
            atmosphere = new THREE.Mesh(geometry, material);
            scene.add(atmosphere);
        }
        
        function createClouds() {
            // Create cloud geometry
            const geometry = new THREE.SphereGeometry(5.05, 32, 32);
            
            // Create cloud material
            const material = new THREE.MeshPhongMaterial({
                color: 0xffffff,
                transparent: true,
                opacity: 0.4,
                alphaMap: createCloudTexture(512)
            });
            
            clouds = new THREE.Mesh(geometry, material);
            scene.add(clouds);
        }
        
        function createCloudTexture(size) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size / 2;
            const ctx = canvas.getContext('2d');
            
            // Create cloud pattern
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, size, size / 2);
            
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 100; i++) {
                const x = Math.random() * size;
                const y = Math.random() * (size / 2);
                const radius = Math.random() * 20 + 5;
                
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            return new THREE.CanvasTexture(canvas);
        }
        
        function createNightLights() {
            // Create night lights geometry
            const geometry = new THREE.SphereGeometry(5.02, 32, 32);
            
            // Create night lights material
            const material = new THREE.MeshBasicMaterial({
                color: 0xffffff,
                transparent: true,
                opacity: 0.8,
                alphaMap: createNightLightsTexture(512)
            });
            
            nightLights = new THREE.Mesh(geometry, material);
            scene.add(nightLights);
        }
        
        function createNightLightsTexture(size) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size / 2;
            const ctx = canvas.getContext('2d');
            
            // Create night lights pattern
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, size, size / 2);
            
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 200; i++) {
                const x = Math.random() * size;
                const y = Math.random() * (size / 2);
                const radius = Math.random() * 3 + 1;
                
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            return new THREE.CanvasTexture(canvas);
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            // Update controls
            controls.update();
            
            // Rotate Earth
            if (earth) {
                earth.rotation.y += 0.001;
            }
            
            // Rotate clouds
            if (clouds) {
                clouds.rotation.y += 0.002;
            }
            
            // Rotate night lights
            if (nightLights) {
                nightLights.rotation.y += 0.0015;
            }
            
            // Update stats
            updateStats();
            
            // Render scene
            renderer.render(scene, camera);
        }
        
        function updateStats() {
            stats.fps = Math.round(1000 / (performance.now() - (stats.lastTime || performance.now())));
            stats.lastTime = performance.now();
            
            document.getElementById('fps').textContent = stats.fps;
            document.getElementById('mode').textContent = isRealisticMode ? 'Realistic' : 'Wireframe';
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // Control functions
        function toggleMode() {
            isRealisticMode = !isRealisticMode;
            if (earth) {
                earth.material.wireframe = !isRealisticMode;
            }
        }
        
        function toggleAtmosphere() {
            atmosphereVisible = !atmosphereVisible;
            if (atmosphere) {
                atmosphere.visible = atmosphereVisible;
            }
        }
        
        function toggleClouds() {
            cloudsVisible = !cloudsVisible;
            if (clouds) {
                clouds.visible = cloudsVisible;
            }
        }
        
        function resetCamera() {
            camera.position.set(0, 0, 15);
            controls.reset();
        }
        
        function changeQuality(newQuality) {
            quality = newQuality;
            console.log('Quality changed to:', quality);
            // In a real implementation, you would recreate the Earth with new quality settings
        }
        
        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
