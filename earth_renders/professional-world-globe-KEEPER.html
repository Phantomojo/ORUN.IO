<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional World Globe - Real Geographic Data</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #fff;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }
        
        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #globe-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            backdrop-filter: blur(10px);
        }
        
        .controls h3 {
            margin: 0 0 15px 0;
            color: #00ff88;
            font-size: 18px;
        }
        
        .controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 10px;
            background: #111;
            color: #fff;
            border: 1px solid #333;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .controls button:hover {
            background: #222;
            border-color: #00ff88;
        }
        
        .controls button.active {
            background: #00ff88;
            color: #000;
        }
        
        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            min-width: 250px;
            backdrop-filter: blur(10px);
        }
        
        .info-panel h4 {
            margin: 0 0 10px 0;
            color: #00ff88;
        }
        
        .info-panel .stat {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            text-align: center;
        }
        
        .loading h2 {
            color: #00ff88;
            margin-bottom: 20px;
        }
        
        .loading .progress {
            width: 400px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .loading .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #0088ff);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .performance-stats {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #333;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }
        
        .map-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #333;
            min-width: 200px;
            backdrop-filter: blur(10px);
        }
        
        .map-info h4 {
            margin: 0 0 10px 0;
            color: #00ff88;
        }
        
        .map-info .info-item {
            margin: 5px 0;
            font-size: 12px;
        }
        
        .error-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            text-align: center;
            background: rgba(255, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #ff0000;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="globe-container"></div>
        
        <div class="loading" id="loading">
            <h2>Loading Professional World Globe</h2>
            <div class="progress">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div id="loading-text">Loading...</div>
        </div>
        
        <div class="controls" id="controls" style="display: none;">
            <h3>Professional Globe Controls</h3>
            <button onclick="toggleAutoRotate()" id="rotate-btn">Auto Rotate</button>
            <button onclick="toggleWireframe()" id="wireframe-btn">Show Wireframe</button>
            <button onclick="toggleAtmosphere()" id="atmosphere-btn">Atmosphere</button>
            <button onclick="toggleNightMode()" id="night-btn">Night Mode</button>
            <button onclick="changeMapStyle()">Change Map Style</button>
            <button onclick="resetView()">Reset View</button>
        </div>
        
        <div class="info-panel" id="info-panel" style="display: none;">
            <h4>Globe Statistics</h4>
            <div class="stat">Map Resolution: <span id="map-resolution">5400x2700</span></div>
            <div class="stat">Sphere Segments: <span id="sphere-segments">128x64</span></div>
            <div class="stat">FPS: <span id="fps">0</span></div>
            <div class="stat">Render Mode: <span id="render-mode">Professional</span></div>
            <div class="stat">Map Style: <span id="map-style">NASA Topography</span></div>
        </div>
        
        <div class="map-info" id="map-info">
            <h4>Map Information</h4>
            <div class="info-item">Projection: Equirectangular</div>
            <div class="info-item">Source: NASA Earth Observatory</div>
            <div class="info-item">Format: High-Resolution JPEG</div>
            <div class="info-item">Wrapping: Seamless</div>
        </div>
        
        <div class="performance-stats" id="perf-stats">
            <div>Frame Time: <span id="frame-time">0</span>ms</div>
            <div>Memory: <span id="memory-usage">0</span>MB</div>
            <div>Texture Size: <span id="texture-size">5400x2700</span></div>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <script>
        // Global variables
        let scene, camera, renderer, controls;
        let earth, atmosphere, wireframe;
        let autoRotate = false;
        let showWireframe = false;
        let showAtmosphere = true;
        let nightMode = false;
        let currentMapStyle = 0;
        
        // Performance tracking
        let frameCount = 0;
        let lastTime = 0;
        let fps = 0;
        
        // Real world map textures
        const MAP_STYLES = [
            {
                name: "NASA Topography",
                url: "world-map-4k.jpg",
                resolution: "5400x2700",
                description: "NASA Earth Observatory topographic map"
            },
            {
                name: "NASA Blue Marble",
                url: "world-map-8k.jpg", 
                resolution: "8192x4096",
                description: "NASA Blue Marble night lights"
            },
            {
                name: "Political Map",
                url: "world-map-political.png",
                resolution: "2048x1024",
                description: "Political world map with country borders"
            }
        ];
        
        // Initialize the application
        async function init() {
            updateProgress(10, "Initializing Three.js...");
            
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000011);
            
            // Create camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 15);
            
            // Create renderer with high quality settings
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true,
                powerPreference: "high-performance"
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.getElementById('globe-container').appendChild(renderer.domElement);
            
            // Create controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.autoRotate = false;
            controls.autoRotateSpeed = 0.5;
            controls.minDistance = 8;
            controls.maxDistance = 50;
            
            updateProgress(30, "Loading high-resolution world map...");
            
            // Load world map texture
            const mapTexture = await loadWorldMapTexture();
            
            updateProgress(60, "Creating professional 3D globe...");
            
            // Create the Earth sphere with real map texture
            createProfessionalEarthGlobe(mapTexture);
            
            updateProgress(80, "Adding atmospheric effects...");
            
            // Create atmosphere
            createAtmosphere();
            
            // Create wireframe
            createWireframe();
            
            updateProgress(100, "Professional globe ready!");
            
            // Hide loading screen and show controls
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('controls').style.display = 'block';
                document.getElementById('info-panel').style.display = 'block';
            }, 500);
            
            // Start animation loop
            animate();
        }
        
        // Load world map texture
        async function loadWorldMapTexture() {
            return new Promise((resolve, reject) => {
                const loader = new THREE.TextureLoader();
                const currentMap = MAP_STYLES[currentMapStyle];
                
                loader.load(
                    currentMap.url,
                    (texture) => {
                        // Configure texture for professional quality
                        texture.wrapS = THREE.RepeatWrapping;
                        texture.wrapT = THREE.ClampToEdgeWrapping;
                        texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
                        texture.minFilter = THREE.LinearMipmapLinearFilter;
                        texture.magFilter = THREE.LinearFilter;
                        texture.generateMipmaps = true;
                        
                        console.log(`Loaded professional map: ${currentMap.name} (${currentMap.resolution})`);
                        resolve(texture);
                    },
                    (progress) => {
                        const percent = Math.round((progress.loaded / progress.total) * 100);
                        updateProgress(30 + (percent * 0.3), `Loading ${currentMap.name}... ${percent}%`);
                    },
                    (error) => {
                        console.error('Error loading map texture:', error);
                        showError('Failed to load world map texture. Please check your internet connection.');
                        reject(error);
                    }
                );
            });
        }
        
        // Show error message
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.innerHTML = `
                <h3>Error</h3>
                <p>${message}</p>
                <button onclick="location.reload()">Retry</button>
            `;
            document.getElementById('container').appendChild(errorDiv);
        }
        
        // Create the professional Earth globe
        function createProfessionalEarthGlobe(mapTexture) {
            // Create high-detail sphere geometry
            const geometry = new THREE.SphereGeometry(5, 128, 64);
            
            // Create professional material with the world map texture
            const material = new THREE.MeshPhongMaterial({
                map: mapTexture,
                transparent: false,
                shininess: 0,
                specular: new THREE.Color(0x111111),
                bumpScale: 0.1
            });
            
            // Create the Earth mesh
            earth = new THREE.Mesh(geometry, material);
            earth.castShadow = true;
            earth.receiveShadow = true;
            scene.add(earth);
            
            // Add professional lighting setup
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            directionalLight.shadow.camera.near = 0.5;
            directionalLight.shadow.camera.far = 50;
            scene.add(directionalLight);
            
            // Add rim lighting for better definition
            const rimLight = new THREE.DirectionalLight(0x4488ff, 0.3);
            rimLight.position.set(-10, -10, -5);
            scene.add(rimLight);
            
            console.log("Professional Earth globe created with real NASA data");
        }
        
        // Create realistic atmosphere effect
        function createAtmosphere() {
            const geometry = new THREE.SphereGeometry(5.1, 64, 32);
            const material = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    intensity: { value: 0.8 }
                },
                vertexShader: `
                    varying vec3 vNormal;
                    varying vec3 vPosition;
                    void main() {
                        vNormal = normalize(normalMatrix * normal);
                        vPosition = position;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `,
                fragmentShader: `
                    varying vec3 vNormal;
                    varying vec3 vPosition;
                    uniform float time;
                    uniform float intensity;
                    
                    void main() {
                        float fresnel = pow(1.0 - dot(vNormal, vec3(0, 0, 1.0)), 2.0);
                        float atmosphere = fresnel * intensity;
                        
                        // Add subtle animation
                        float pulse = sin(time * 0.5) * 0.1 + 0.9;
                        atmosphere *= pulse;
                        
                        gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0) * atmosphere;
                    }
                `,
                blending: THREE.AdditiveBlending,
                side: THREE.BackSide,
                transparent: true
            });
            
            atmosphere = new THREE.Mesh(geometry, material);
            atmosphere.visible = showAtmosphere;
            scene.add(atmosphere);
        }
        
        // Create wireframe
        function createWireframe() {
            const geometry = new THREE.SphereGeometry(5.05, 32, 16);
            const material = new THREE.MeshBasicMaterial({
                color: 0x333333,
                wireframe: true,
                transparent: true,
                opacity: 0.2
            });
            
            wireframe = new THREE.Mesh(geometry, material);
            wireframe.visible = showWireframe;
            scene.add(wireframe);
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            const currentTime = performance.now();
            const deltaTime = currentTime - lastTime;
            lastTime = currentTime;
            
            // Update FPS
            frameCount++;
            if (frameCount % 60 === 0) {
                fps = Math.round(1000 / deltaTime);
                document.getElementById('fps').textContent = fps;
            }
            
            // Auto rotate
            if (autoRotate) {
                earth.rotation.y += 0.005;
                if (atmosphere) {
                    atmosphere.rotation.y += 0.005;
                }
                if (wireframe) {
                    wireframe.rotation.y += 0.005;
                }
            }
            
            // Update atmosphere shader
            if (atmosphere && atmosphere.material.uniforms) {
                atmosphere.material.uniforms.time.value = currentTime * 0.001;
            }
            
            controls.update();
            renderer.render(scene, camera);
            
            // Update performance stats
            updatePerformanceStats(deltaTime);
        }
        
        // Update progress bar
        function updateProgress(percent, text) {
            document.getElementById('progress-bar').style.width = percent + '%';
            document.getElementById('loading-text').textContent = text;
        }
        
        // Update performance statistics
        function updatePerformanceStats(frameTime) {
            document.getElementById('frame-time').textContent = frameTime.toFixed(1);
            
            // Mock memory usage
            const memoryUsage = 80 + Math.random() * 20; // Simulate memory usage
            document.getElementById('memory-usage').textContent = memoryUsage.toFixed(1);
        }
        
        // Control functions
        function toggleAutoRotate() {
            autoRotate = !autoRotate;
            controls.autoRotate = autoRotate;
            document.getElementById('rotate-btn').classList.toggle('active', autoRotate);
        }
        
        function toggleWireframe() {
            showWireframe = !showWireframe;
            if (wireframe) {
                wireframe.visible = showWireframe;
            }
            document.getElementById('wireframe-btn').classList.toggle('active', showWireframe);
        }
        
        function toggleAtmosphere() {
            showAtmosphere = !showAtmosphere;
            if (atmosphere) {
                atmosphere.visible = showAtmosphere;
            }
            document.getElementById('atmosphere-btn').classList.toggle('active', showAtmosphere);
        }
        
        function toggleNightMode() {
            nightMode = !nightMode;
            if (nightMode) {
                scene.background = new THREE.Color(0x000000);
                document.getElementById('night-btn').classList.add('active');
            } else {
                scene.background = new THREE.Color(0x000011);
                document.getElementById('night-btn').classList.remove('active');
            }
        }
        
        function resetView() {
            camera.position.set(0, 0, 15);
            controls.reset();
        }
        
        async function changeMapStyle() {
            currentMapStyle = (currentMapStyle + 1) % MAP_STYLES.length;
            const newMap = MAP_STYLES[currentMapStyle];
            
            document.getElementById('loading').style.display = 'block';
            updateProgress(50, `Loading ${newMap.name}...`);
            
            try {
                const newTexture = await loadWorldMapTexture();
                earth.material.map = newTexture;
                earth.material.needsUpdate = true;
                
                // Update UI
                document.getElementById('map-resolution').textContent = newMap.resolution;
                document.getElementById('map-style').textContent = newMap.name;
                document.getElementById('texture-size').textContent = newMap.resolution;
                
                document.getElementById('loading').style.display = 'none';
                console.log(`Switched to ${newMap.name}`);
            } catch (error) {
                console.error('Error changing map style:', error);
                document.getElementById('loading').style.display = 'none';
                showError('Failed to load new map style.');
            }
        }
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
