!function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s(s.s=2)}({2:function(e,t,s){e.exports=s("qeEv")},qeEv:function(e,t){!function(){!function(){var e=location.hash;if(void 0!==e[1]){if($target=$(e),parentID=$target.attr("parent-id"),void 0!==parentID){var t=$target.closest(".js-replies-wrapper").siblings(".js-replies-link"),s=t.find(".js-reply-link-text");t.addClass("is-open"),s.text(s.attr("data-text-hide"))}$("html, body").animate({scrollTop:$target.offset().top},700)}setTimeout(function(){$(".prediction").scrollTop(0)},500)}();var e=$(".prediction");function t(e){if(kaspersky.isAuthorized){if(!kaspersky.voted){kaspersky.voted=!0;var t=$("#vote_"+e+"_count");t.text(parseInt(t.text())+1),"agree"===e?($(".js-agree").addClass("active"),$(".js-disagree").addClass("disable")):($(".js-disagree").addClass("active"),$(".js-agree").addClass("disable")),kaspersky.voteApi({brief_id:kaspersky.briefId,agree:e}).fail(function(e){alert(e.statusText)})}}else window.location=kaspersky.loginUrl+"?next="+location.pathname}function s(e){if(e.preventDefault(),kaspersky.isAuthorized){var t=$(".js-comment-add textarea"),s=t.val();""!==s.trim()&&(t.val("").blur(),i(),$.post(langUrl+"api/predictions/"+kaspersky.briefId+"/comment",{text:s}).done(function(e){if("ok"===e.status){var t='<div class="comment__wrap js-comments-item comment-owner" id="'+e.id+'"> <div class="comment__author" style="background-image: url(/'+kaspersky.userAvatar+')"></div><div class="comment__wrapper js-comment-root"> <span class="comment__name js-comment-name">'+kaspersky.userName+'</span> <span class="comment__text js-comment-text">'+e.text+'</span> <div class="comment__tools"> <span class="comment__date">'+moment().format("DD MMM YYYY")+'</span> <span class="comment__like js-like-btn"> <span class="comment__like-icon js-like-icon"> <svg width="14px" height="13px" viewBox="0 0 14 13" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Desktop" stroke="none" stroke-width="1" fill-rule="evenodd"> <g id="Replies-v.1.2" transform="translate(-210.000000, -1781.000000)" stroke="#00FFA7"> <g id="Group-8" transform="translate(68.000000, 1725.000000)"> <g id="Group-5" transform="translate(142.000000, 55.000000)"> <g id="heart" transform="translate(0.000000, 2.000000)"> <path d="M10.035,0 C11.118,0 11.967,0.296 12.58,0.889 C13.193,1.482 13.5,2.299 13.5,3.343 C13.5,4.053 13.245,4.781 12.735,5.523 C12.48,5.903 12.185,6.251 11.851,6.567 L7.382,10.857 C7.27646826,10.9498269 7.14054635,11.0007086 7,11.0000141 C6.85958415,11.0009849 6.72367798,10.9504648 6.618,10.858 L2.148,6.567 C1.83166904,6.27740031 1.55101903,5.95109431 1.312,5.595 C0.772,4.82 0.5,4.07 0.5,3.343 C0.5,2.3 0.807,1.482 1.42,0.889 C2.033,0.296 2.882,0 3.965,0 C4.523,0 5.112,0.19 5.733,0.569 C6.163,0.822 6.586,1.146 7,1.541 C7.414,1.146 7.836,0.821 8.267,0.569 C8.887,0.189 9.477,0 10.035,0 Z" id="Path"></path> </g> </g> </g> </g> </g> </svg> </span> <span class="comment__like-qty js-like-counter">0</span> </span> <span class="comment__reply js-comment-reply">reply</span> </div><span class="comment__reply-link js-replies-link"> <span> <span class="comment__reply-link-text js-reply-link-text" data-text-show="Show replies" data-text-hide="Hide replies">Show replies</span> <span class="js-replies-count comment__replies-count is-zero">(<span class="comment__replies-counter js-replies-counter">4</span>)</span> </span> <span class="comment__reply-link-arrow js-reply-arrow"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="15" height="15" viewBox="0 0 15 15"> <defs> <path id="a" d="M8.415 11.485L4.314 7.387c-.172-.18-.232-.253-.232-.376-.001-.123.06-.19.235-.376L8.48 2.48c.564-.559 1.391.268.832.831l-3.714 3.7 3.648 3.642a.59.59 0 0 1-.83.832z"/> </defs> <g fill="none" fill-rule="evenodd" transform="matrix(0 1 1 0 1 1)"> <rect width="14" height="14" fill="#030303" fill-opacity=".01" stroke="#50E3C2" stroke-width=".01" opacity=".01" rx="3"/> <use fill="#00FFA7" xlink:href="#a"/> </g> </svg> </span> </span> <div class="comment__replies js-replies-wrapper"> <div class="comment__replies-container js-replies-container"> </div><div class="comment__replies-form "> <div class="prediction__comment comment js-reply-form-container"> </div></div></div><div class="comment__delete js-popup-comment"> <svg width="14px" height="14px" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g id="Desktop" stroke="none" stroke-width="1" fill-rule="evenodd"> <g id="Replies-v.1.2" transform="translate(-924.000000, -1657.000000)" fill-rule="nonzero"> <g id="cross" transform="translate(924.000000, 1657.000000)"> <polygon id="Path" points="8.88066667 6.90106667 13.8021333 11.8225333 11.8225333 13.8021333 6.90106667 8.88066667 1.9796 13.8021333 0 11.8225333 4.92146667 6.90106667 0 1.9796 1.9796 0 6.90106667 4.92146667 11.8225333 0 13.8021333 1.9796"></polygon> </g> </g> </g> </svg> </div></div></div>',s=$(t).clone();$(".js-comment-list").prepend(s)}}).fail(function(e){alert(e.statusText)}))}else window.location=kaspersky.loginUrl+"?next="+location.pathname}function n(){$(".popup").removeClass("is-visible")}function i(){e.find(".js-comments-item").each(function(){$(this).find(".js-comment-name").text()===kaspersky.userName&&$(this).addClass("comment-owner")})}function a(){e.find(".js-replies-link").each(function(){$(this).find(".js-reply-link-text");var e=$(this).siblings(".js-replies-wrapper").children(".js-replies-container").children(".js-comments-item").length;e>0?$(this).addClass("is-active"):$(this).removeClass("is-active"),$(this).find(".js-replies-counter").text(e)})}e.find(".js-agree").on("click",function(){t("agree")}),e.find(".js-disagree").on("click",function(){t("disagree")}),e.find(".js-comment-add").on("submit",s),e.find(".js-comment-add textarea").on("keyup",function(e){13===e.keyCode&&s(e)}),i(),a(),$(document).on("click",".js-replies-link",function(){var e,t=$(this).find(".js-reply-link-text");$(this).hasClass("is-open")?(e=t.attr("data-text-show"),$(this).removeClass("is-open")):(e=t.attr("data-text-hide"),$(this).addClass("is-open")),t.text(e)}),$(document).on("click",".js-comment-reply",function(){var e=$(this).parent().siblings(".js-replies-link").find(".js-reply-link-text"),t=e.attr("data-text-hide");e.text(t);var s=$(this).parent().siblings(".js-comment-name").text(),n=$(".js-reply-form-template").clone().removeClass("js-reply-form-template"),i=$(this).closest(".js-comments-item").attr("id");n.find(".js-reply-add").attr("data-reply-id",i);var a=$(this).closest(".js-comment-root").find(".js-reply-form-container");a.children().length||a.append(n),$(this).parent().siblings(".js-replies-link").addClass("is-open"),$(a).find("textarea").val(s+", ").focus()}),$(document).on("submit",".js-reply-add",function(e){e.preventDefault(),$(this).find(".comment__send").attr("disabled",!0);var t=this,s=$(this).children("textarea").val(),n=$(this).closest(".js-comments-item").attr("id"),o=$(this).attr("data-reply-id"),r={text:s,parentID:n,replyID:o};$.ajax({url:langUrl+"api/predictions/"+kaspersky.briefId+"/comment",method:"POST",data:r,type:"json",success:function(e){var s='<div class="comment__wrap js-comments-item" parent-id="'+n+'" id="'+e.id+'"> <div class="comment__author" style="background-image: url(/'+kaspersky.userAvatar+')"></div><div class="comment__wrapper"> <span class="comment__name js-comment-name">'+kaspersky.userName+'</span> <span class="comment__text js-comment-text">'+e.text+'</span> <div class="comment__tools"> <span class="comment__date">'+moment().format("DD MMM YYYY")+'</span> <span class="comment__like js-like-btn"> <span class="comment__like-icon js-like-icon"> <svg width="14px" height="13px" viewBox="0 0 14 13" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Desktop" stroke="none" stroke-width="1" fill-rule="evenodd"> <g id="Replies-v.1.2" transform="translate(-210.000000, -1781.000000)" stroke="#00FFA7"> <g id="Group-8" transform="translate(68.000000, 1725.000000)"> <g id="Group-5" transform="translate(142.000000, 55.000000)"> <g id="heart" transform="translate(0.000000, 2.000000)"> <path d="M10.035,0 C11.118,0 11.967,0.296 12.58,0.889 C13.193,1.482 13.5,2.299 13.5,3.343 C13.5,4.053 13.245,4.781 12.735,5.523 C12.48,5.903 12.185,6.251 11.851,6.567 L7.382,10.857 C7.27646826,10.9498269 7.14054635,11.0007086 7,11.0000141 C6.85958415,11.0009849 6.72367798,10.9504648 6.618,10.858 L2.148,6.567 C1.83166904,6.27740031 1.55101903,5.95109431 1.312,5.595 C0.772,4.82 0.5,4.07 0.5,3.343 C0.5,2.3 0.807,1.482 1.42,0.889 C2.033,0.296 2.882,0 3.965,0 C4.523,0 5.112,0.19 5.733,0.569 C6.163,0.822 6.586,1.146 7,1.541 C7.414,1.146 7.836,0.821 8.267,0.569 C8.887,0.189 9.477,0 10.035,0 Z" id="Path"></path> </g> </g> </g> </g> </g> </svg> </span> <span class="comment__like-qty js-like-counter"></span> </span> <span class="comment__reply js-comment-reply">reply</span> </div><div class="comment__delete js-popup-comment"> <svg width="14px" height="14px" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g id="Desktop" stroke="none" stroke-width="1" fill-rule="evenodd"> <g id="Replies-v.1.2" transform="translate(-924.000000, -1657.000000)" fill-rule="nonzero"> <g id="cross" transform="translate(924.000000, 1657.000000)"> <polygon id="Path" points="8.88066667 6.90106667 13.8021333 11.8225333 11.8225333 13.8021333 6.90106667 8.88066667 1.9796 13.8021333 0 11.8225333 4.92146667 6.90106667 0 1.9796 1.9796 0 6.90106667 4.92146667 11.8225333 0 13.8021333 1.9796"></polygon> </g> </g> </g> </svg> </div></div></div>',o=$(s).clone();$(t).closest(".js-comment-root").find(".js-replies-container").append(o),$(t).closest(".comment__wrap").remove(),i(),a()},error:function(){console.log("Ajax failed")}})}),$(document).on("click",".js-reply-close",function(e){e.preventDefault(),$(this).closest(".comment__wrap").remove()}),$(document).on("click",".js-popup",function(){var e=$(".popup");e.addClass("is-visible"),$(e).on("click","[data-popup-close]",n)}),$(document).on("click",".js-popup-comment",function(){$(".popup").addClass("is-visible");var e=$(this).closest(".js-comments-item");$(document).on("click",".js-delete-comment",function(){!function(e){var t=$(e).attr("id");$.ajax({url:langUrl+"api/predictions/comment/"+t,method:"DELETE",success:function(t){"ok"==t.status?($(e).find(".js-comment-text:first").text(t.text),$(e).find(".comment__delete:last").css("display","none")):"remove"==t.status&&(e.hasClass("comment-owner")&&0==e.siblings(".js-comments-item").length?e.parents(".js-replies-wrapper").siblings(".js-replies-link").remove():e.remove()),n()}})}(e)}),$(document).on("click","[data-popup-close]",n)}),$(document).on("click",".js-like-btn",function(){if(kaspersky.isAuthorized){var e=$(this).children(".js-like-counter").text();e=- -e;var t="";$(this).hasClass("is-active")?($(this).removeClass("is-active"),(e-=1)<=0&&(e=""),t="remove"):($(this).addClass("is-active"),e+=1,t="add"),$(this).children(".js-like-counter").text(e);var s=$(this).closest(".js-comments-item").attr("id");$.ajax({url:langUrl+"api/predictions/comment/"+s+"/like/"+t,method:"POST",success:function(e){}})}else window.location=kaspersky.loginUrl+"?next="+location.pathname}),$(document).on("keydown","textarea",function(e){13===e.keyCode&&e.preventDefault()}),$(document).on("keydown",".js-reply-add textarea",function(e){13===e.keyCode&&$(this).parent().trigger("submit")})}()}});
//# sourceMappingURL=prediction.js.map