function computeTangents(){throw console.log("buffer"),new Error("BufferGeometryUtils: computeTangents renamed to computeMikkTSpaceTangents.")}function computeMikkTSpaceTangents(e,t){function o(e){if(e.normalized||e.isInterleavedBufferAttribute){for(var t=new Float32Array(e.getCount()*e.itemSize),o=0,r=0;o<e.getCount();o++)t[r++]=e.getX(o),t[r++]=e.getY(o),e.itemSize>2&&(t[r++]=e.getZ(o));return t}return e.array instanceof Float32Array?e.array:new Float32Array(e.array)}var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||!t.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!e.hasAttribute("position")||!e.hasAttribute("normal")||!e.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');var a=e.index?e.toNonIndexed():e,n=t.generateTangents(o(a.attributes.position),o(a.attributes.normal),o(a.attributes.uv));if(r)for(var i=3;i<n.length;i+=4)n[i]*=-1;return a.setAttribute("tangent",new BufferAttribute(n,4)),e!==a&&e.copy(a),e}function mergeBufferGeometries(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=!1;e[0]&&null!==e[0].index&&(o=!0);for(var r=new Set(Object.keys(e[0].attributes)),a=new Set(Object.keys(e[0].morphAttributes)),n={},i={},s=e[0].morphTargetsRelative,l=new THREE.BufferGeometry,u=0,d=0;d<e.length;++d){var c=e[d],p=0;if(o!==(null!==c.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var f in c.attributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;void 0===n[f]&&(n[f]=[]),n[f].push(c.attributes[f]),p++}if(p!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(s!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var m in c.morphAttributes){if(!a.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===i[m]&&(i[m]=[]),i[m].push(c.morphAttributes[m])}if(t){var h=void 0;if(o)h=c.index.count;else{if(void 0===c.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;h=c.attributes.position.count}l.addGroup(u,h,d),u+=h}}if(o){for(var g=0,v=[],w=0;w<e.length;++w){for(var E=e[w].index,T=0;T<E.count;++T)v.push(E.getX(T)+g);g+=e[w].attributes.position.count}l.setIndex(v)}for(var y in n){var b=mergeBufferAttributes(n[y]);if(!b)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+y+" attribute."),null;l.setAttribute(y,b)}for(var x in i){var R=i[x][0].length;if(0===R)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[x]=[];for(var _=0;_<R;++_){for(var A=[],M=0;M<i[x].length;++M)A.push(i[x][M][_]);var H=mergeBufferAttributes(A);if(!H)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+x+" morphAttribute."),null;l.morphAttributes[x].push(H)}}return l}function mergeBufferAttributes(e){for(var t=void 0,o=void 0,r=void 0,a=0,n=0;n<e.length;++n){var i=e[n];if(i.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=i.array.constructor),t!==i.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===o&&(o=i.itemSize),o!==i.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===r&&(r=i.normalized),r!==i.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;a+=i.array.length}for(var s=new t(a),l=0,u=0;u<e.length;++u)s.set(e[u].array,l),l+=e[u].array.length;return new THREE.BufferAttribute(s,o,r)}function deepCloneAttribute(e){return e.isInstancedInterleavedBufferAttribute||e.isInterleavedBufferAttribute?deinterleaveAttribute(e):e.isInstancedBufferAttribute?(new InstancedBufferAttribute).copy(e):(new THREE.BufferAttribute).copy(e)}function interleaveAttributes(e){for(var t=void 0,o=0,r=0,a=0,n=e.length;a<n;++a){var i=e[a];if(void 0===t&&(t=i.array.constructor),t!==i.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;o+=i.array.length,r+=i.itemSize}for(var s=new InterleavedBuffer(new t(o),r),l=0,u=[],d=["getX","getY","getZ","getW"],c=["setX","setY","setZ","setW"],p=0,f=e.length;p<f;p++){var m=e[p],h=m.itemSize,g=m.count,v=new InterleavedBufferAttribute(s,h,l,m.normalized);u.push(v),l+=h;for(var w=0;w<g;w++)for(var E=0;E<h;E++)v[c[E]](w,m[d[E]](w))}return u}function deinterleaveAttribute(e){var t=e.data.array.constructor,o=e.count,r=e.itemSize,a=e.normalized,n=new t(o*r),i=void 0;i=e.isInstancedInterleavedBufferAttribute?new InstancedBufferAttribute(n,r,a,e.meshPerAttribute):new BufferAttribute(n,r,a);for(var s=0;s<o;s++)i.setX(s,e.getX(s)),r>=2&&i.setY(s,e.getY(s)),r>=3&&i.setZ(s,e.getZ(s)),r>=4&&i.setW(s,e.getW(s));return i}function deinterleaveGeometry(e){var t=e.attributes,o=e.morphTargets,r=new Map;for(var a in t){var n=t[a];n.isInterleavedBufferAttribute&&(r.has(n)||r.set(n,deinterleaveAttribute(n)),t[a]=r.get(n))}for(var i in o){var s=o[i];s.isInterleavedBufferAttribute&&(r.has(s)||r.set(s,deinterleaveAttribute(s)),o[i]=r.get(s))}}function estimateBytesUsed(e){var t=0;for(var o in e.attributes){var r=e.getAttribute(o);t+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}var a=e.getIndex();return t+=a?a.count*a.itemSize*a.array.BYTES_PER_ELEMENT:0}function mergeVertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);for(var o={},r=e.getIndex(),a=e.getAttribute("position"),n=r?r.count:a.count,i=0,s=Object.keys(e.attributes),l={},u={},d=[],c=["getX","getY","getZ","getW"],p=["setX","setY","setZ","setW"],f=0,m=s.length;f<m;f++){var h=s[f],g=e.attributes[h];l[h]=new BufferAttribute(new g.array.constructor(g.count*g.itemSize),g.itemSize,g.normalized);var v=e.morphAttributes[h];v&&(u[h]=new BufferAttribute(new v.array.constructor(v.count*v.itemSize),v.itemSize,v.normalized))}for(var w=Math.log10(1/t),E=Math.pow(10,w),T=0;T<n;T++){for(var y=r?r.getX(T):T,b="",x=0,R=s.length;x<R;x++)for(var _=s[x],A=e.getAttribute(_),M=A.itemSize,H=0;H<M;H++)b+=~~(A[c[H]](y)*E)+",";if(b in o)d.push(o[b]);else{for(var P=0,S=s.length;P<S;P++)for(var I=s[P],k=e.getAttribute(I),B=e.morphAttributes[I],L=k.itemSize,D=l[I],z=u[I],C=0;C<L;C++){var U=c[C],F=p[C];if(D[F](i,k[U](y)),B)for(var V=0,O=B.length;V<O;V++)z[V][F](i,B[V][U](y))}o[b]=i,d.push(i),i++}}var W=e.clone();for(var G in e.attributes){var j=l[G];if(W.setAttribute(G,new BufferAttribute(j.array.slice(0,i*j.itemSize),j.itemSize,j.normalized)),G in u)for(var Y=0;Y<u[G].length;Y++){var X=u[G][Y];W.morphAttributes[G][Y]=new BufferAttribute(X.array.slice(0,i*X.itemSize),X.itemSize,X.normalized)}}return W.setIndex(d),W}function toTrianglesDrawMode(e,t){if(t===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===TriangleFanDrawMode||t===TriangleStripDrawMode){var o=e.getIndex();if(null===o){var r=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var n=0;n<a.count;n++)r.push(n);e.setIndex(r),o=e.getIndex()}var i=o.count-2,s=[];if(t===TriangleFanDrawMode)for(var l=1;l<=i;l++)s.push(o.getX(0)),s.push(o.getX(l)),s.push(o.getX(l+1));else for(var u=0;u<i;u++)u%2==0?(s.push(o.getX(u)),s.push(o.getX(u+1)),s.push(o.getX(u+2))):(s.push(o.getX(u+2)),s.push(o.getX(u+1)),s.push(o.getX(u)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var d=e.clone();return d.setIndex(s),d.clearGroups(),d}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function computeMorphedAttributes(e){function t(e,t,c,p,f,m,h,g){o.fromBufferAttribute(t,f),r.fromBufferAttribute(t,m),a.fromBufferAttribute(t,h);var v=e.morphTargetInfluences;if(c&&v){l.set(0,0,0),u.set(0,0,0),d.set(0,0,0);for(var w=0,E=c.length;w<E;w++){var T=v[w],y=c[w];0!==T&&(n.fromBufferAttribute(y,f),i.fromBufferAttribute(y,m),s.fromBufferAttribute(y,h),p?(l.addScaledVector(n,T),u.addScaledVector(i,T),d.addScaledVector(s,T)):(l.addScaledVector(n.sub(o),T),u.addScaledVector(i.sub(r),T),d.addScaledVector(s.sub(a),T)))}o.add(l),r.add(u),a.add(d)}e.isSkinnedMesh&&(e.boneTransform(f,o),e.boneTransform(m,r),e.boneTransform(h,a)),g[3*f+0]=o.x,g[3*f+1]=o.y,g[3*f+2]=o.z,g[3*m+0]=r.x,g[3*m+1]=r.y,g[3*m+2]=r.z,g[3*h+0]=a.x,g[3*h+1]=a.y,g[3*h+2]=a.z}var o=new Vector3,r=new Vector3,a=new Vector3,n=new Vector3,i=new Vector3,s=new Vector3,l=new Vector3,u=new Vector3,d=new Vector3,c=e.geometry,p=e.material,f=void 0,m=void 0,h=void 0,g=c.index,v=c.attributes.position,w=c.morphAttributes.position,E=c.morphTargetsRelative,T=c.attributes.normal,y=c.morphAttributes.position,b=c.groups,x=c.drawRange,R=void 0,_=void 0,A=void 0,M=void 0,H=void 0,P=void 0,S=void 0,I=new Float32Array(v.count*v.itemSize),k=new Float32Array(T.count*T.itemSize);if(null!==g)if(Array.isArray(p))for(R=0,A=b.length;R<A;R++)for(H=b[R],P=Math.max(H.start,x.start),S=Math.min(H.start+H.count,x.start+x.count),_=P,M=S;_<M;_+=3)f=g.getX(_),m=g.getX(_+1),h=g.getX(_+2),t(e,v,w,E,f,m,h,I),t(e,T,y,E,f,m,h,k);else for(P=Math.max(0,x.start),S=Math.min(g.count,x.start+x.count),R=P,A=S;R<A;R+=3)f=g.getX(R),m=g.getX(R+1),h=g.getX(R+2),t(e,v,w,E,f,m,h,I),t(e,T,y,E,f,m,h,k);else if(Array.isArray(p))for(R=0,A=b.length;R<A;R++)for(H=b[R],P=Math.max(H.start,x.start),S=Math.min(H.start+H.count,x.start+x.count),_=P,M=S;_<M;_+=3)f=_,m=_+1,h=_+2,t(e,v,w,E,f,m,h,I),t(e,T,y,E,f,m,h,k);else for(P=Math.max(0,x.start),S=Math.min(v.count,x.start+x.count),R=P,A=S;R<A;R+=3)f=R,m=R+1,h=R+2,t(e,v,w,E,f,m,h,I),t(e,T,y,E,f,m,h,k);return{positionAttribute:v,normalAttribute:T,morphedPositionAttribute:new Float32BufferAttribute(I,3),morphedNormalAttribute:new Float32BufferAttribute(k,3)}}function mergeGroups(e){if(0===e.groups.length)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),e;var t=e.groups;if(t=t.sort(function(e,t){return e.materialIndex!==t.materialIndex?e.materialIndex-t.materialIndex:e.start-t.start}),null===e.getIndex()){for(var o=e.getAttribute("position"),r=[],a=0;a<o.count;a+=3)r.push(a,a+1,a+2);e.setIndex(r)}for(var n=e.getIndex(),i=[],s=0;s<t.length;s++)for(var l=t[s],u=l.start,d=u+l.count,c=u;c<d;c++)i.push(n.getX(c));e.dispose(),e.setIndex(i);for(var p=0,f=0;f<t.length;f++){var m=t[f];m.start=p,p+=m.count}var h=t[0];e.groups=[h];for(var g=1;g<t.length;g++){var v=t[g];h.materialIndex===v.materialIndex?h.count+=v.count:(h=v,e.groups.push(h))}return e}function toCreasedNormals(e){function t(e){return~~(e.x*a)+","+~~(e.y*a)+","+~~(e.z*a)}for(var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI/3,r=Math.cos(o),a=100*(1+1e-10),n=[new Vector3,new Vector3,new Vector3],i=new Vector3,s=new Vector3,l=new Vector3,u=new Vector3,d=e.toNonIndexed(),c=d.attributes.position,p={},f=0,m=c.count/3;f<m;f++){var h=3*f,g=n[0].fromBufferAttribute(c,h+0),v=n[1].fromBufferAttribute(c,h+1),w=n[2].fromBufferAttribute(c,h+2);i.subVectors(w,v),s.subVectors(g,v);for(var E=(new Vector3).crossVectors(i,s).normalize(),T=0;T<3;T++){var y=n[T],b=t(y);b in p||(p[b]=[]),p[b].push(E)}}for(var x=new Float32Array(3*c.count),R=new BufferAttribute(x,3,!1),_=0,A=c.count/3;_<A;_++){var M=3*_,H=n[0].fromBufferAttribute(c,M+0),P=n[1].fromBufferAttribute(c,M+1),S=n[2].fromBufferAttribute(c,M+2);i.subVectors(S,P),s.subVectors(H,P),l.crossVectors(i,s).normalize();for(var I=0;I<3;I++){var k=n[I],B=t(k),L=p[B];u.set(0,0,0);for(var D=0,z=L.length;D<z;D++){var C=L[D];l.dot(C)>r&&u.add(C)}u.normalize(),R.setXYZ(M+I,u.x,u.y,u.z)}}return d.setAttribute("normal",R),d}function Planet(e,t,o,r){function a(e){if(e.preventDefault(),e.touches){var t=e.touches[0];S=t.clientX,I=t.clientY}else S=e.clientX*w,I=e.clientY*w;s(S,I),M=0,A=!0}function n(e){A=!1,f.state==f.IDLE&&(M>6||p()&&u())}function i(e){if(e.preventDefault(),e.touches){var t=e.touches[0];S=t.clientX,I=t.clientY}else S=e.clientX*w,I=e.clientY*w;s(S,I)}function s(e,t){k=Math.abs(R.x-e),B=Math.abs(R.y-t),M+=k*k+B*B,R.x=e,R.y=t,p()?(_.x=2*(R.x/m.originalSize.width-.5),_.y=2*-(R.y/m.originalSize.height-.5)):(_.x=2*(R.x/m.width-.5),_.y=2*-(R.y/m.height-.5))}function l(){if(f.state==f.IDLE){var e,t;return P.setFromCamera(_,g),e=P.ray.intersectSphere(H,new THREE.Vector3),e&&(t=f.getClosestLocation(e)),!(!t||t==f.location_current)&&(d(t),!0)}}function u(){var e,t;P.setFromCamera(_,g),e=P.ray.intersectSphere(H,new THREE.Vector3),e&&(t=f.getClosestLocation(e)),t?d(t,!0):f.deactivateHexagon()}function d(t,o){if(!window.earthDemo||!window.earthDemo.running){f.deactivateHexagon(),e.controls.autoRotate=!1,f.location_current=t,L=t,t.briefs=PlanetData.hasLocationAnyBriefs(L,!0),t.briefs_text=PlanetData.hasLocationAnyBriefTexts(L,!0),t.works_list=PlanetData.getWorkList(L,!0),t.more=PlanetData.getMoreText(L,!0);var r=[t];if(kaspersky.getHexaspherePopup){var a=function e(){f.deactivateHexagon(),i.off("mouseleave",e)},n=kaspersky.getHexaspherePopup(r,c,o);C=n.element,z=n.close;var i=$(C);i.on("mouseleave",a)}D.position.copy(t.position),e.controls.autoRotate=!1,t.light.visible=!1,f.commentToggle(!1)}}function c(t){var o,r=t.years[PlanetData.YEAR_ID];o="brief"===r.type?langUrl+r.brief_id:langUrl+"locations/"+PlanetData.YEAR_ID+"/"+t.location_id,f.state=f.ANIMATED,e.controls.dispose(),m.style.cursor="default",f.deactivateHexagon(),f.commentToggle(!1),U.lookAt(t.position);var a=U.quaternion.clone();U.lookAt(e.camera.position);var n=U.quaternion.clone();U.updateMatrix();var i=e.camera.position.length();U.add(e.camera),e.camera.position.set(0,0,i),e.camera.rotation.set(0,0,0),h.updateMatrixWorld(),U._anim_progress_=0,TweenLite.to(U,1.5,{_anim_progress_:1,ease:Sine.easeInOut,onUpdate:function(){U.quaternion.slerpQuaternions(n,a,U._anim_progress_),U.updateMatrix()},onComplete:function(){TweenLite.to(e.camera.position,1.2,{z:1.15*v,ease:Sine.easeIn,onComplete:function(){}}),setTimeout(kaspersky.Transition.fadeIn,400),setTimeout(function(){kaspersky.navigateTo(o)},400)}})}var p=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e};console.log("function Planet");var f=($(".debug"),window.PLANET=this);f.isMobile=p,f.main=e;var m=e.renderer.domElement,h=f.scene=e.scene,g=e.camera,v=f.radius=10,w=f.ratio=window.devicePixelRatio||1;f.speedMultiple=.8;var E=f.container=new THREE.Object3D;h.add(E);var T=f.static_container=new THREE.Object3D;h.add(T),T.matrixAutoUpdate=!1;f.textureLoader=new THREE.TextureLoader;f.planet_color=10941859,f.water_color=8491355,f.LOADING="loading",f.IDLE="idle",f.ANIMATED="animated",f.state=f.LOADING,f.data=t,t.countries_by_id={};for(var y=0;y<t.countries.length;y++){var b=t.countries[y];t.countries_by_id[b.country_id]=b}t.locations_by_id={};for(var y=0;y<t.locations.length;y++){var b=t.locations[y];t.locations_by_id[b.location_id]=b}f._PlanetCommentPopup=PlanetCommentPopup(f.main.$container),f.commentToggle=function(e){f._PlanetCommentPopup&&(e?f._PlanetCommentPopup.showRandom():f._PlanetCommentPopup.hide())},f.locationsFullData=!1,f.getLocationBriefs=function(e,t){var o=f.data.locations_by_id[e],a=o.brief_list;if(a)return void(!1!=!!a[PlanetData.YEAR_ID]&&t(a[PlanetData.YEAR_ID].briefs));f.locationsFullData?(a=o.brief_list=f.locationsFullData[e]||{},!1!=!!a[PlanetData.YEAR_ID]&&t(a[PlanetData.YEAR_ID].briefs)):r().done(function(r){f.locationsFullData=r,a=o.brief_list=f.locationsFullData[e]||{},!1!=!!a[PlanetData.YEAR_ID]&&t(a[PlanetData.YEAR_ID].briefs)})},f.drawPoints(1.1*v),f.drawParticles(v),f.drawBG(),f.drawSputniks(),f.drawOrbitas(),f.planetLocations=new PlanetLocations(f),f.planetPointed=new PlanetPointed(f),f.planetContour=new PlanetContour(f);var x;f.update=function(){x=g.position.distanceToSquared(new THREE.Vector3)-100;var t=new THREE.Vector3;if(g.getWorldPosition(t),T.lookAt(t),T.updateMatrix(),f.grid_shpere.rotation.y+=5e-4*f.speedMultiple,f.orbits)for(var o=0;o<f.orbits.length;o++){var r=f.orbits[o];r.rotation.x+=r._increment.x*f.speedMultiple,r.rotation.y+=r._increment.y*f.speedMultiple,r.rotation.z+=r._increment.z*f.speedMultiple}if(f.sputniks)for(var o=0;o<f.sputniks.length;o++)if(!(f.frozen&&f.frozen.indexOf("sputnik"+o)>-1)){var a=f.sputniks[o];a.rotation.y+=.002*f.speedMultiple}if(f.particles&&(f.particles.rotation.y+=.001*f.speedMultiple),f.planetPointed.update(),f.updateBg&&f.updateBg(),C){D.updateMatrix();var t=new THREE.Vector3;D.getWorldPosition(t);var n=t.clone().project(g);n.x=(n.x+1)/2*window.canvasWidth,n.y=-(n.y-1)/2*(window.earthDemo&&window.earthDemo.createMode?document.documentElement.offsetHeight:window.innerHeight),C.style.transform="translate("+n.x+"px, "+n.y+"px)",f.isInFrontOfPlanet(D.position)||f.deactivateHexagon()}if(f._PlanetCommentPopup&&f._PlanetCommentPopup.update(),f.state!=f.IDLE||p()||l(),f.demoTargetLocation){var i=new THREE.Vector3(0,1,1);f.demoTargetLocation.position.clone().applyEuler(new THREE.Euler(0,e.camera.getWorldRotation().y,0,"XYZ")).projectOnPlane(i).x>Math.PI&&(f.demoMoveToHexagon(f.demoTargetLocation,f.demoCallback),f.demoTargetLocation=null)}},f.tile_current=null;var R=new THREE.Vector2(-2,-2),_=R.clone(),A=!1,M=0;console.log(f.container.position.clone());var H=new THREE.Sphere(f.container.position.clone(),v),P=new THREE.Raycaster;P.setFromCamera(R,g),m.addEventListener("touchstart",a,!1),m.addEventListener("touchmove",i,!1),m.addEventListener("touchend",n,!1),m.addEventListener("mousedown",a,!1),m.addEventListener("mousemove",i,!1),m.addEventListener("mouseup",n,!1);var S,I,k,B,L=null,D=new THREE.Object3D;D.matrixAutoUpdate=!1,f.container.add(D);var z,C=null;f.deactivateHexagon=function(){L&&("function"==typeof z&&z(),C=null,f.location_current=null,L.light.visible=!0,L=null,e.controls.autoRotate=!0,f.commentToggle(!0))};var U=new THREE.Object3D;U.up=new THREE.Vector3(0,1,0),e.scene.add(U),U.matrixAutoUpdate=!1,f.changeSpeed=function(t){e.controls.autoRotateSpeed=1*t,f.speedMultiple=t};var F=!0;f.demoStartLocation=function(e,t,o){!1===e&&(e=0);var r=Object.assign({},f.planetLocations.current_locations[e]);o&&F&&(F=!1,r.position.x-=2,r.position.y-=1),f.changeSpeed(4),f.demoTargetLocation=r,f.demoCallback=t},f.demoMoveToHexagon=function(t,o){f.state=f.ANIMATED,console.log("demoMoveToHexagon"),e.controls.dispose(),e.controls.autoRotate=!1,f.commentToggle(!1),U.lookAt(t.position);var r=U.quaternion.clone();t.position.clone();U.lookAt(e.camera.getWorldPosition()),U.setRotationFromEuler(e.camera.getWorldRotation());var a=U.quaternion.clone();e.camera.getWorldPosition().clone().applyEuler(e.camera.getWorldRotation());U.updateMatrix();var n=e.camera.position.length();U.add(e.camera),e.camera.position.set(0,0,n),e.camera.rotation.set(0,0,0),h.updateMatrixWorld(),U._anim_progress_=0,TweenLite.to(U,1.5,{_anim_progress_:1,ease:Sine.easeInOut,onUpdate:function(){THREE.Quaternion.slerp(a,r,U.quaternion,U._anim_progress_),U.updateMatrix()},onComplete:function(){f.demoStartZ=e.camera.position.z,f.demoLocation=t,TweenLite.to(e.camera.position,1.2,{z:1.15*v,ease:Sine.easeIn,onComplete:function(){o&&o()}}),setTimeout(kaspersky.Transition.fadeIn,400)}})},f.demoMoveFromHexagon=function(t){TweenLite.to(e.camera.position,1.2,{z:f.demoStartZ,ease:Sine.easeOut,onComplete:function(){P.setFromCamera(_,g),e.controls.autoRotate=!0,e.controls.attach(),f.state=f.IDLE,t&&t()}})},f.stopSputnik=function(e){f.frozen||(f.frozen=[]),f.frozen.push("sputnik"+e)},f.startSputnik=function(){f.frozen=[]},f.demoMoveToSputnik=function(t,o){f.stopSputnik(t),f.state=f.ANIMATED,console.log("demoMoveToSputnik"),e.controls.dispose(),e.controls.autoRotate=!1,f.commentToggle(!1),U.lookAt(window.PLANET.sputniks[t].children[0].getWorldPosition());var r=U.quaternion.clone();U.lookAt(e.camera.getWorldPosition()),U.setRotationFromEuler(e.camera.getWorldRotation());var a=U.quaternion.clone();U.updateMatrix();var n=e.camera.position.length();U.add(e.camera),e.camera.position.set(0,0,n),e.camera.rotation.set(0,0,0),h.updateMatrixWorld(),U._anim_progress_=0,TweenLite.to(U,5,{_anim_progress_:1,ease:Sine.easeInOut,onUpdate:function(){THREE.Quaternion.slerp(a,r,U.quaternion,U._anim_progress_),U.updateMatrix()},onComplete:function(){f.demoStartZ=e.camera.position.z,f.demoLocation=location,TweenLite.to(e.camera.position,1.2,{z:1.4*v,ease:Sine.easeIn,onComplete:function(){o&&o()}}),setTimeout(kaspersky.Transition.fadeIn,400)}})},f.demoMoveFromSputnik=function(t){TweenLite.to(e.camera.position,1.2,{z:f.demoStartZ,ease:Sine.easeOut,onComplete:function(){P.setFromCamera(_,g),e.controls.autoRotate=!0,e.controls.attach(),f.state=f.IDLE,f.startSputnik(),t&&t()}})},f.stopEarth=function(){f.state=f.ANIMATED,console.log("stop earth"),e.controls.dispose(),e.controls.autoRotate=!1,f.commentToggle(!1),setTimeout(kaspersky.Transition.fadeIn,400)},f.startEarth=function(){P.setFromCamera(_,g),e.controls.autoRotate=!0,e.controls.attach(),f.state=f.IDLE},f.isInFrontOfPlanet=function(e){return!(g.position.distanceToSquared(e)>x)},f.googlePosToUV=function(e,t){if(void 0===e){var o="40.705565,-74.1180857".split(",");e=o[0],t=o[1]}var r=1-(parseFloat(e)+90)/180;(r+=.014)>1&&(r-=1);var a=(parseFloat(t)+180)/360;return a-=.031,a<0&&(a=1+a),{u:r,v:a}};var V=window.currentYear||PlanetData.year_ids[0];o(),e.animateOut(.05,function(){f.showYear(V,void 0,6)})}function Hexagon(e){var t=new THREE.Color(16777215),o=(new THREE.Color(5275216),Utils.createHexagon(.5)),r=o.material;return r.transparent=!0,r.opacity=.4,r.blending=THREE.AdditiveBlending,r.depthWrite=!1,o._anim_progress=.001,o.scale.set(o._anim_progress,o._anim_progress,o._anim_progress),o.setToLocation=function(a){o.location=a,o.position.copy(a.position),o.lookAt(new THREE.Vector3),r.color=t,e.add(o),o.matrixAutoUpdate=!0,TweenLite.killTweensOf(o),TweenLite.to(o,.2,{_anim_progress:.8,onUpdate:function(){o.scale.set(o._anim_progress,o._anim_progress,o._anim_progress)},onComplete:function(){o.matrixAutoUpdate=!1}})},o.hide=function(t){o.matrixAutoUpdate=!0,TweenLite.killTweensOf(o),TweenLite.to(o,1,{_anim_progress:.001,onUpdate:function(){o.scale.set(o._anim_progress,o._anim_progress,o._anim_progress)},onComplete:function(){e.remove(o),t.push(o),o.matrixAutoUpdate=!1}})},o}function PlanetLocations(e){function t(e,t){var o=0;e.opacity=0,TweenLite.killTweensOf(e),TweenLite.to(e,.3,{delay:t-.3,ease:Sine.easeOut,onUpdate:function(){o+=1,e.opacity=Math.round(o%2)*d},onComplete:function(){e.opacity=d}})}function o(t,o){var r=0;TweenLite.killTweensOf(t),TweenLite.to(t,.3,{ease:Sine.easeInOut,onUpdate:function(){r+=1,t.opacity=Math.round(r%2)*d},onComplete:function(){e.container.remove(i)}})}function r(e,t){for(var o=2*Math.random()+1,r=new THREE.PlaneGeometry(.3,o,1),a=new THREE.Mesh(r,t?T:w),n=r.getAttribute("position"),i=new THREE.Vector3,s=0;s<n.count;s++)i.fromBufferAttribute(n,s),i.applyMatrix4((new THREE.Matrix4).makeRotationX(Math.PI/2)),i.add(new THREE.Vector3(0,0,-o/2)),n.setXYZ(s,i.x,i.y,i.z);n.needsUpdate=!0;var l=a.clone();return a.add(l),l.rotation.z=Math.PI/2,l.matrixAutoUpdate=!1,l.updateMatrix(),a.position.copy(e),a.lookAt(new THREE.Vector3),a.matrixAutoUpdate=!1,a.updateMatrix(),a}function a(e,t){var o=w.map.offset;TweenLite.to(o,e,{delay:t,y:0,ease:Sine.easeInOut})}function n(e){var t=w.map.offset;TweenLite.to(t,e,{y:-1,ease:Sine.easeInOut})}var i,s=e.data,l=s.locations,u=this?this:{};u.current_locations;for(var d=.8,c=new THREE.MeshBasicMaterial({transparent:!0,opacity:0,color:new THREE.Color(16768512),blending:THREE.AdditiveBlending,side:THREE.DoubleSide,depthWrite:!1}),p=new THREE.MeshBasicMaterial({transparent:!0,opacity:0,color:new THREE.Color(16777215),blending:THREE.AdditiveBlending,side:THREE.DoubleSide,depthWrite:!1}),f=[],m=0;m<l.length;m++)f.push(l[m].preview);var h=Utils.createHexagon(.15,!1,void 0),g=Utils.createHexagon(.2,!1,void 0,.02);h.add(g);var v=1.005*e.radius;new THREE.Vector3;u.init=function(t){var o=new THREE.Object3D;o.matrixAutoUpdate=!1;for(var a=o._locations=[],n=0;n<l.length;n++){var i=l[n];a.push(i)}for(var n=0;n<a.length;n++){var i=a[n];if(!1!=!!i.years[t]){var u=i.years[t];if(u.briefs){i.country=s.countries_by_id[i.country_id];var d=e.googlePosToUV(i.planet_u,i.planet_v);Utils.setFromSpherical(v,d.v,d.u,h.position),h.lookAt(new THREE.Vector3),h.updateMatrix(),h.updateMatrixWorld();var f=h.clone();f.material=u.works?c:p,f.lookAt(new THREE.Vector3),f.updateMatrix(),f.updateMatrixWorld(),o.add(f),i.position=h.position.clone(),i.light=r(h.position,u.works),o.add(i.light)}}}return o},u.show=function(o,r){var n=PlanetData.years[o];n.locations_container||(n.locations_container=u.init(o)),i=n.locations_container,u.current_locations=i._locations,e.container.add(i),t(c,r),t(p,r),a(r/2,r/2)},u.hide=function(e){o(c,e),o(p,e),n(e/2)};var w=new THREE.MeshBasicMaterial({transparent:!0,opacity:.9,blending:THREE.AdditiveBlending,side:THREE.DoubleSide,depthWrite:!1,fog:!0}),E=w;E.map=e.textureLoader.load(PlanetData.textures_path+"lightray.jpg"),E.map.wrapT=THREE.ClampToEdgeWrapping;var T=w.clone();T.map=e.textureLoader.load(PlanetData.textures_path+"lightray_yellow.jpg")}function PlanetPointed(e){var t=e.textureLoader.load(PlanetData.textures_path+"dot.png");t.generateMipalphaMaps=!1,t.magFilter=THREE.LinearFilter,t.minFilter=THREE.LinearFilter;for(var o=[],r=0;r<2;r++){var a=new THREE.PointsMaterial({size:.15/e.ratio});a.color=new THREE.Color(3257463),a.map=t,a.depthWrite=!1,a.transparent=!0,a.opacity=0,a.blending=THREE.AdditiveBlending;var n=r/2;a.t_=n*Math.PI*2,a.speed_=.04,a.min_=.2*Math.random()+.5,a.delta_=.1*Math.random()+.1,a.opacity_coef_=1,o.push(a)}var i,s;this.init=function(t){var r=new THREE.Object3D;r.matrixAutoUpdate=!1;for(var a=[],n=0;n<2;n++)a[n]={positions:[]};var i=new THREE.Spherical;i.radius=e.radius;for(var l=new THREE.Vector3,u=PlanetData.years[t].earth_image,d=0;d<250;d++)for(var c=250*(1-Math.sin(d/250*Math.PI))/250+.5,p=0;p<250;p+=c){var f=p/250,m=d/250,h=u.isLandByUV(f,m);if(h){var g=a[Math.floor(2*Math.random())];i.theta=f*Math.PI*2-Math.PI/2,i.phi=m*Math.PI,l.setFromSpherical(i),g.positions.push(l.x),g.positions.push(l.y),g.positions.push(l.z)}}for(var n=0;n<a.length;n++){for(var g=a[n],v=new THREE.BufferGeometry,w=new Float32Array(g.positions.length),E=0;E<g.positions.length;E++)w[E]=g.positions[E];v.setAttribute("position",new THREE.BufferAttribute(w,3)),v.computeBoundingSphere(),g.material=o[n];var T=g.mesh=new THREE.Points(v,g.material);T.matrixAutoUpdate=!1,r.add(T)}e.radius;s=new THREE.MeshBasicMaterial({transparent:!0,opacity:0,color:new THREE.Color(3257463),blending:THREE.AdditiveBlending,depthWrite:!1});for(var y,b,x,R,_=Utils.createHexagon(.12,!1,s,.025),A=[],M=.01,H=(Math.PI,!1),P=.5-Math.PI;P<-.6;P+=.04){x=.5*Math.cos(P)+.5,H=!H,M=Math.abs(.01/Math.sin(x*Math.PI)),y=Math.floor(1/M);for(var S=0;S<y;S++)b=.5+(y/2-S-(H?.5:0))*M,R=x,Math.random()>.25||u.isLandByUV(b,R)||u.isLandByUV(b-.02,R)||u.isLandByUV(b+.02,R)||u.isLandByUV(b,R-.02)||u.isLandByUV(b,R+.02)||(Utils.setFromSpherical(e.radius*(.97-.01*Math.random()),b,R,_.position),_.lookAt(new THREE.Vector3),_.updateMatrix(),_.updateMatrixWorld(),A.push(_.geometry.clone().applyMatrix4(_.matrixWorld)))}var I=mergeBufferGeometries(A),k=new THREE.Mesh(I,s);return k.matrixAutoUpdate=!1,r.add(k),r},this.update=function(){for(var e=0;e<o.length;e++){var t=o[e];t.t_+=t.speed_,t.opacity=(Math.sin(t.t_)*t.delta_+t.min_)*t.opacity_coef_}},this.show=function(t,r){var a=PlanetData.years[t];a.pointed_sphere||(a.pointed_sphere=this.init(t)),i=a.pointed_sphere,e.container.add(i);for(var n=0;n<o.length;n++){var l=o[n];TweenLite.killTweensOf(l),TweenLite.to(l,r,{opacity_coef_:1,ease:Sine.easeInOut,onComplete:function(){}})}TweenLite.killTweensOf(s),TweenLite.to(s,r,{opacity:.4,ease:Sine.easeInOut})},this.hide=function(t){for(var r=0;r<o.length;r++){var a=o[r];TweenLite.killTweensOf(a),TweenLite.to(a,t,{opacity_coef_:0,ease:Sine.easeInOut,onComplete:function(){e.container.remove(i)}})}TweenLite.killTweensOf(s),TweenLite.to(s,t,{opacity:0,ease:Sine.easeInOut})}}function PlanetCommentPopup(e){var t,o=!1,r=window.PLANET,a=this?this:{},n=$("<div class='planet-comment-line'>").appendTo(e).hide(),i=$("<div class='planet-comment'>").appendTo(e).hide(),s=$("<div class='planet-comment-text'>").appendTo(i),l=r.main.camera,u=new THREE.Object3D;r.container.add(u),a.show=function(e,a,l,d){if((!window.earthDemo||!window.earthDemo.running)&&e){if(r.state!=r.IDLE)return void setTimeout(show.bind(this,e.name,a,l,d),2e3);n.show(),s.text(e.name),s.attr("href",e.id),s.on("click",function(){location.href=$(this).attr("href"),console.log("click")}),i.stop().show(200),o=!0,u.position.copy(a),l&&(clearTimeout(t),t=setTimeout(function(){hide(d)},l))}},a.hide=function(e){clearTimeout(t),
i.stop().hide(200,function(){n.hide(),o=!1,e&&e()})};var d;return a.showRandom=function(){var e,t=r.planetLocations.current_locations;if(clearTimeout(d),!t)return void(d=setTimeout(this.showRandom,100));for(var o=0;t.length>0&&o<10&&(e=t[~~(Math.random()*t.length)],!(e.position&&PlanetData.hasLocationAnyBriefs(e,!0)&&r.isInFrontOfPlanet(e.position)));o++)e=null;if(!e)return void(d=setTimeout(this.showRandom,200));r.getLocationBriefs(e.location_id,function(t){if(t&&t.length){var o=t[~~(Math.random()*t.length)];show(o,e.position,3e3,showRandom)}else d=setTimeout(this.showRandom,100)})},a.update=function(){if(o){var e=u.getWorldPosition(),t=e.clone().project(l);t.x=(t.x+1)/2*window.canvasWidth,t.y=-(t.y-1)/2*window.innerHeight;var a=e.clone().multiplyScalar(1.1).project(l);a.x=(a.x+1)/2*window.canvasWidth,a.y=-(a.y-1)/2*window.innerHeight,i.css({transform:"translate("+a.x+"px, "+a.y+"px)",height:"auto",width:"auto"});var s=t.x-a.x,d=t.y-a.y,c=Math.sqrt(s*s+d*d)+1,p=Math.atan2(d+1,s);n.css({transform:"translate("+a.x+"px, "+a.y+"px) rotate("+p+"rad)",width:c+"px"}),r.isInFrontOfPlanet(e)||showRandom()}},this}function ProjectiveImage(e,t){var o,r=document.createElement("img");r.src=e,r.onload=function(){var e=document.createElement("canvas");o=e.getContext("2d"),e.width=r.width,e.height=r.height,o.drawImage(r,0,0,r.width,r.height),t&&t()};var a=null;this.isLand=function(e,t){var n=parseInt(r.width*(t+180)/360),i=parseInt(r.height*(e+90)/180);return null==a&&(a=o.getImageData(0,0,r.width,r.height)),0===a.data[4*(i*a.width+n)]},this.isLandByUV=function(e,t){null==a&&(a=o.getImageData(0,0,r.width,r.height));var n=parseInt(r.width*e),i=parseInt(r.height*t);return 0===a.data[4*(i*a.width+n)]},this.getUV=function(e,t){return{x:(t+180)/360,y:(e+90)/180}},this.getUVOfPI=function(e,t){return{x:(t+Math.PI)/Utils.PI2,y:(e+Utils.PIh)/Math.PI}}}THREE.AlphaColorShader={uniforms:{color:{value:new THREE.Color(16777215)},fogType:{value:1},fogNear:{value:10},fogFar:{value:30}},vertexShader:["attribute float alpha;","varying float vAlpha;","void main() {","vAlpha = alpha;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = 4.0;","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform int fogType;","uniform float fogNear;","uniform float fogFar;","varying float vAlpha;","void main() {","vec3 fogColor = vec3(0,0,0);","gl_FragColor = vec4( color, vAlpha * ( gl_FragCoord.z ) );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n"),transparent:!0},THREE.XRayMaterial=function(e){var t={uTex:{type:"t",value:e.map||new THREE.Texture},offsetRepeat:{value:new THREE.Vector4(0,0,1,1)},alphaProportion:{type:"1f",value:e.alphaProportion||.5},diffuse:{value:e.color||new THREE.Color(16777215)},opacity:{value:e.opacity||1},gridOffset:{value:0}};return setInterval(function(){t.gridOffset.value+=e.gridOffsetSpeed||1},40),new THREE.ShaderMaterial({uniforms:t,vertexShader:"\t\t\tvarying float _alpha;\t\t\tvarying vec2 vUv;\t\t\tuniform vec4 offsetRepeat;\t\t\tuniform float alphaProportion;\t\t\t\t\t    void main() {\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\t\t\t\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\t\t\t\t\t\t\t\tvec4 worldPosition = modelMatrix * vec4( vec3( position ), 1.0 );\t\t\t\tvec3 cameraToVertex = normalize( cameraPosition - worldPosition.xyz);\t\t\t\t_alpha = 1.0 - max( 0.0, dot( normal, cameraToVertex ) );\t\t\t\t_alpha = max( 0.0, (_alpha - alphaProportion) / (1.0 - alphaProportion) );\t\t    }",fragmentShader:"uniform sampler2D uTex;      uniform vec3 diffuse;      uniform float opacity;      uniform float gridOffset;          varying float _alpha;    varying vec2 vUv;            void main() {      vec4 texColor = texture2D( uTex, vUv );      float _a = _alpha * opacity;      if( _a <= 0.0 ) discard;      _a = _a * ( sin( vUv.y * 2000.0 + gridOffset ) * .5 + .5 );      gl_FragColor = vec4( texColor.rgb * diffuse, _a );        }",transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1})},function(e){function t(){var e=!(window.innerWidth>1e3)||window.earthDemo&&window.earthDemo.running?window.innerWidth:window.innerWidth-302,t=window.innerHeight;window.earthDemo&&window.earthDemo.createMode&&(e=!(document.documentElement.offsetWidth>1e3)||window.earthDemo&&window.earthDemo.running?document.documentElement.offsetWidth:document.documentElement.offsetWidth-302,t=document.documentElement.offsetHeight),window.canvasWidth=e,u.domElement.originalSize={width:e,height:t},c.aspect=e/t,c.updateProjectionMatrix(),u.setPixelRatio(window.earthDemo&&window.earthDemo.running?1:s),u.setSize(e,t),p&&(p.setSize(e,t),m.uniforms.resolution.value.set(1/e,1/t),h.uniforms.v.value=1/t)}function o(){y||(w.state!=w.ANIMATED&&v.update(),w.update(),p?p.render():u.render(l,c),g&&g.update(u),T=window.requestAnimationFrame(o))}function r(){a()||(console.log("reInitContext"),$(u.domElement).remove(),u=n.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0,powerPreference:"high-performance"}),u.autoClearColor=new THREE.Color(0,0,0,0),u.setPixelRatio(1),i.append(u.domElement),u.domElement.addEventListener("webglcontextlost",function(){a()||(b=!0,y||r())}),p=new THREE.EffectComposer(u),f=new THREE.RenderPass(l,c),p.addPass(f),f=new THREE.ShaderPass(THREE.RGBShiftShader),f.uniforms.amount.value=.001,p.addPass(f),m=f=new THREE.ShaderPass(THREE.FXAAShader),p.addPass(f),h=f=new THREE.ShaderPass(THREE.VerticalTiltShiftShader),f.uniforms.r.value=.35,f.renderToScreen=!0,p.addPass(f),window.resizeEarth(),p?p.render():u.render(l,c))}console.log("Planet Main"),console.log(e);var a=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},n=this?this:{},i=n.$container=$(".main-container");if(!Detector.webgl)return void i.hide();var s=void 0!==window.devicePixelRatio?window.devicePixelRatio:1,l=n.scene=new THREE.Scene;l.fog=new THREE.Fog(0,7,40);var u=n.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0,powerPreference:"high-performance"});u.autoClearColor=new THREE.Color(0,0,0,0),u.setPixelRatio(s);var d=u.domElement;i.append(d);var c=n.camera=new THREE.PerspectiveCamera(60,window.earthDemo&&window.earthDemo.createMode?document.documentElement.offsetWidth/document.documentElement.offsetHeight:window.innerWidth/window.innerHeight,.1,700);c.position.set(-16,11,0),c.lookAt(new THREE.Vector3);var p;if(!a()){var f;p=new THREE.EffectComposer(u),f=new THREE.RenderPass(l,c),p.addPass(f),f=new THREE.ShaderPass(THREE.RGBShiftShader),f.uniforms.amount.value=.001,p.addPass(f);var m=f=new THREE.ShaderPass(THREE.FXAAShader);p.addPass(f);var h=f=new THREE.ShaderPass(THREE.VerticalTiltShiftShader);f.uniforms.r.value=.35,f.renderToScreen=!0,p.addPass(f)}var g;window.addEventListener("resize",t,!1),t(),window.resizeEarth=t;var v=n.controls=new THREE.OrbitControls(c,u.domElement);v.minPolarAngle=.15*Math.PI,v.maxPolarAngle=.85*Math.PI,v.enableDamping=!0,v.dampingFactor=.063,v.autoRotate=!0,v.autoRotateSpeed=1,v.enableZoom=!0,v.minDistance=18,v.maxDistance=20,v.zoomSpeed=.2,v.zoomFactor=.1;var w;console.log("planet in planet main");var E=e.ready.addWait();e.planetMain=function(e,t){e().then(function(e){setTimeout(function(){w=new Planet(n,e,function(){E.resolve(),E=void 0},t),o()},500)}).fail(function(){console.log("error")}).always(function(){})},$(document).trigger("panetMainLoaded");var T,y=!1,b=!1;u.domElement.addEventListener("webglcontextlost",function(){a()||(b=!0,y||r())}),i.on("animate:start",function(){y=!1,a()?($(u.domElement).remove(),u=n.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0,powerPreference:"high-performance"}),u.autoClearColor=new THREE.Color(0,0,0,0),u.setPixelRatio(1),i.append(u.domElement),u.domElement.addEventListener("webglcontextlost",function(){a()||(b=!0,y||r())}),window.resizeEarth(),p?p.render():u.render(l,c)):b?(b=!1,r()):u.setPixelRatio(1),o()}),i.on("animate:stop",function(){y=!0,u.setPixelRatio(1),window.cancelAnimationFrame(T),u.clear(!0,!0,!0),u.dispose(),a()&&(window.navigator.userAgent.indexOf("MSIE ")>0||window.navigator.userAgent.match(/Trident.*rv\:11\./)||u.context.isContextLost()||u.forceContextLoss())}),n.animateIn=function(e,t){console.log("animateIn"),e=e||3,TweenLite.to(v,e,{autoRotateSpeed:1,ease:Sine.easeOut}),c.updateProjectionMatrix(),TweenLite.to(c,e,{fov:60,ease:Sine.easeInOut,onUpdate:function(){c.updateProjectionMatrix()},onComplete:function(){t&&t()}})},n.animateOut=function(e,t){console.log("animateOut"),e=e||2,TweenLite.to(c,e,{fov:10,ease:Sine.easeInOut,onUpdate:function(){c.updateProjectionMatrix()},onComplete:function(){t&&t()}})}}(kaspersky=kaspersky||{}),Planet.prototype.getClosestLocation=function(e){for(var t,o=this.isMobile()?.15:.04,r=this.planetLocations.current_locations,a=0;a<r.length;a++){var n=r[a];if(n.position&&PlanetData.hasLocationAnyBriefs(n,!0)){var i=e.distanceToSquared(n.position);if(i<o){o=i,t=n;break}}}return t},Planet.prototype.getAnyClosestLocation=function(e,t){for(var o,r=1e4,a=scope.planetLocations.current_locations,n=0;n<a.length;n++){var i=a[n];if(!t||!function(e){for(var o=0;o<t.length;o++)if(t[o]==e)return!0;return!1}(i)){var s=e.distanceToSquared(i.position);s<r&&(r=s,o=i)}}return o},Planet.prototype.drawPoints=function(e){console.log("drawPoints"),this.grid_shpere=new THREE.Object3D;var t=new THREE.SphereGeometry(1.1*e,66,44),o=new THREE.XRayMaterial({normalMap:this.textureLoader.load(PlanetData.textures_path+"clouds.jpg"),alphaTest:.5,color:new THREE.Color(263385797),opacity:1}),r=new THREE.Mesh(t,o);r.matrixAutoUpdate=!1,this.container.add(r);for(var a=t.getAttribute("position"),n=3*a.count,i=new Float32Array(n),s=new Float32Array(n),l=new Float32Array(n),u=new THREE.Color(16777215),d=0;d<a.count;d++){var c=3*d;i[c]=a.getX(d),i[c+1]=a.getY(d),i[c+2]=a.getZ(d),s[c]=u.r,s[c+1]=u.g,s[c+2]=u.b,l[d]=.3*Math.random()+.5}var p=new THREE.BufferGeometry;p.setAttribute("position",new THREE.BufferAttribute(i,3)),p.setAttribute("color",new THREE.BufferAttribute(s,3)),p.setAttribute("alpha",new THREE.BufferAttribute(l,1)),p.computeBoundingSphere();var f=new THREE.ShaderMaterial(THREE.AlphaColorShader);f.depthWrite=!1,f.uniforms.fogNear.value=10,f.uniforms.fogFar.value=20;var m=new THREE.Points(p,f);m.matrixAutoUpdate=!1,this.grid_shpere.add(m)},Planet.prototype.drawParticles=function(e){for(var t=new Float32Array(1800),o=new THREE.Color(263385797),r=new THREE.Spherical,a=new THREE.Vector3,n=0;n<600;n++){var i=3*n;r.radius=e*(1+.6*Math.random()),r.theta=8*Math.random(),r.phi=.3+2.2*Math.random(),a.setFromSpherical(r),t[i]=a.x,t[i+1]=a.y,t[i+2]=a.z}var s=new THREE.BufferGeometry;s.setAttribute("position",new THREE.BufferAttribute(t,3)),s.computeBoundingSphere();var l=new THREE.PointsMaterial;l.size=.1/this.ratio,l.color=o,l.transparent=!0,l.opacity=.6,l.blending=THREE.AdditiveBlending,l.depthWrite=!1;var u=new THREE.Points(s,l);u.matrixAutoUpdate=!1,this.particles=new THREE.Object3D,this.scene.add(this.particles),this.particles.add(u)},Planet.prototype.drawRing=function(e,t,o,r,a){var n=new THREE.RingGeometry(t,t+o,64,1),i=new THREE.Matrix4;a?i.setPosition(new THREE.Vector3(0,0,.29*t)):i.makeRotationX(Math.PI/2);for(var s=n.getAttribute("position"),l=new THREE.Vector3,u=0;u<s.count;u++)l.fromBufferAttribute(s,u),l.applyMatrix4(i),s.setXYZ(u,l.x,l.y,l.z);s.needsUpdate=!0;var d=new THREE.MeshBasicMaterial({color:this.planet_color,side:THREE.DoubleSide});d.transparent=!0,d.opacity=.2*Math.random()+.1,d.blending=THREE.AdditiveBlending,d.depthWrite=!1;var c=new THREE.Mesh(n,d);return c.rotation.set(r.x,r.y,r.z),c.position.set(e.x,e.y,e.z),this.container.add(c),c},Planet.prototype.drawOrbitas=function(){this.orbits=[];for(var e=0;e<this.radius;e+=3){var t=new THREE.Vector3(0,e,0),o=Math.cos(t.y/this.radius);o+=Math.random()>.8?.7*Math.random():.2*Math.random();var r=new THREE.Vector3(Math.random()*Math.PI,0,Math.random()*Math.PI);t.y=0;var a=this.drawRing(t,1.1*this.radius,.05*Math.random()+.02,r),n=Utils.getRandSides(.002),i=Utils.getRandSides(.002),s=Utils.getRandSides(.002);a._increment=new THREE.Vector3(n,i,s),this.orbits.push(a)}},Planet.prototype.drawBG=function(){function e(e,o,s,l,c,p){o=o/r*n,s=s/a*i;var f=new THREE.PlaneGeometry(o,s,1),m=t(e);m.opacity=1,m.anim_offset=p||0,d.push(m);var h=new THREE.Mesh(f,m);h.position.x=-n/2+o/2+l/r*n,h.position.y=i/2-s/2-c/a*i,h.position.z=.01,h.matrixAutoUpdate=!1,h.updateMatrix(),u.add(h)}function t(e,t){var r=new THREE.MeshBasicMaterial;return r.fog=!0,r.transparent=!0,r.opacity=0,r.blending=THREE.AdditiveBlending,r.depthWrite=!1,r.map=o.textureLoader.load(PlanetData.textures_path+e,t),r.map.generateMipalphaMaps=!1,r.map.magFilter=THREE.LinearFilter,r.map.minFilter=THREE.LinearFilter,r}var o=this,r=2560,a=1440,n=r/590*this.radius,i=a/590*this.radius,s=new THREE.PlaneGeometry(n,i,1),l=t("bg.jpg",function(){TweenLite.to(l,3,{opacity:1,ease:Sine.easeInOut})}),u=this.bg=new THREE.Mesh(s,l);u.matrixAutoUpdate=!1,this.static_container.add(u);var d=[];e("bg_fragment_left.jpg",933,1011,219,0,0),e("bg_fragment_left_1.jpg",933,1011,219,0,Math.PI),e("bg_fragment_right.jpg",1074,1133,1516,8,Math.PI/3),e("bg_fragment_right_1.jpg",1074,1133,1516,8,Math.PI/3+Math.PI),this.updateBg=function(e){for(var t=0;t<d.length;t++){var o=d[t];o.anim_offset+=.03,o.opacity=.4*Math.sin(o.anim_offset)+.2}}},Planet.prototype.drawSputniks=function(){this.sputniks=[];this.addSputnik("station_b.js",1.2*this.radius,this.container,new THREE.Vector3(-.5,0,0)),this.addSputnik("station_c.js",1.25*this.radius,this.container,new THREE.Vector3(.6,3,-1.2))},Planet.prototype.addSputnik=function(e,t,o,r){var a=this,n=(new THREE.OBJLoader,a.drawRing(new THREE.Vector3,t,.05,new THREE.Vector3));n.material.opacity=.3,console.log(JSON.parse('{"uvs":[[]],"faces":[2,1,2,0,0,2,0,2,3,0,2,1,4,2,0,2,2,4,5,0,2,4,6,5,0,2,5,6,7,0,2,8,9,6,0,2,6,9,7,0,2,8,0,9,0,2,9,0,3,0,2,1,0,11,0,2,11,0,10,0,2,4,1,12,0,2,12,1,11,0,2,6,4,13,0,2,13,4,12,0,2,8,6,14,0,2,14,6,13,0,2,0,8,10,0,2,10,8,14,0,2,11,10,16,0,2,16,10,15,0,2,11,16,12,0,2,12,16,17,0,2,12,17,13,0,2,13,17,18,0,2,14,13,19,0,2,19,13,18,0,2,14,19,10,0,2,10,19,15,0,2,16,15,21,0,2,21,15,20,0,2,17,16,22,0,2,22,16,21,0,2,18,17,23,0,2,23,17,22,0,2,19,18,24,0,2,24,18,23,0,2,15,19,20,0,2,20,19,24,0,2,20,25,21,0,2,21,25,26,0,2,22,21,27,0,2,27,21,26,0,2,23,22,28,0,2,28,22,27,0,2,23,28,24,0,2,24,28,29,0,2,20,24,25,0,2,25,24,29,0,2,26,25,31,0,2,31,25,30,0,2,27,26,32,0,2,32,26,31,0,2,28,27,33,0,2,33,27,32,0,2,29,28,34,0,2,34,28,33,0,2,25,29,30,0,2,30,29,34,0,2,31,30,36,0,2,36,30,35,0,2,31,36,32,0,2,32,36,37,0,2,33,32,38,0,2,38,32,37,0,2,34,33,39,0,2,39,33,38,0,2,34,39,30,0,2,30,39,35,0,2,36,35,41,0,2,41,35,40,0,2,37,36,42,0,2,42,36,41,0,2,38,37,43,0,2,43,37,42,0,2,39,38,44,0,2,44,38,43,0,2,35,39,40,0,2,40,39,44,0,2,41,40,46,0,2,46,40,45,0,2,42,41,47,0,2,47,41,46,0,2,43,42,48,0,2,48,42,47,0,2,44,43,49,0,2,49,43,48,0,2,40,44,45,0,2,45,44,49,0,2,46,45,51,0,2,51,45,50,0,2,47,46,52,0,2,52,46,51,0,2,48,47,53,0,2,53,47,52,0,2,49,48,54,0,2,54,48,53,0,2,45,49,50,0,2,50,49,54,0,2,51,50,56,0,2,56,50,55,0,2,52,51,57,0,2,57,51,56,0,2,53,52,58,0,2,58,52,57,0,2,54,53,59,0,2,59,53,58,0,2,50,54,55,0,2,55,54,59,0,2,60,61,63,0,2,63,61,62,0,2,63,62,65,0,2,65,62,64,0,2,65,64,60,0,2,60,64,61,0,2,66,67,69,0,2,69,67,68,0,2,67,70,68,0,2,68,70,71,0,2,70,66,71,0,2,71,66,69,0,2,72,73,75,0,2,75,73,74,0,2,73,76,74,0,2,74,76,77,0,2,76,72,77,0,2,77,72,75,0,2,78,79,81,0,2,81,79,80,0,2,79,82,80,0,2,80,82,83,0,2,82,84,83,0,2,83,84,85,0,2,84,86,85,0,2,85,86,87,0,2,86,78,87,0,2,87,78,81,0,2,81,80,89,0,2,89,80,88,0,2,80,83,88,0,2,88,83,90,0,2,83,85,90,0,2,90,85,91,0,2,85,87,91,0,2,91,87,92,0,2,87,81,92,0,2,92,81,89,0,2,89,88,94,0,2,94,88,93,0,2,88,90,93,0,2,93,90,95,0,2,90,91,95,0,2,95,91,96,0,2,91,92,96,0,2,96,92,97,0,2,92,89,97,0,2,97,89,94,0,2,94,93,99,0,2,99,93,98,0,2,93,95,98,0,2,98,95,100,0,2,95,96,100,0,2,100,96,101,0,2,96,97,101,0,2,101,97,102,0,2,97,94,102,0,2,102,94,99,0,2,99,98,104,0,2,104,98,103,0,2,98,100,103,0,2,103,100,105,0,2,100,101,105,0,2,105,101,106,0,2,101,102,106,0,2,106,102,107,0,2,102,99,107,0,2,107,99,104,0,2,104,103,109,0,2,109,103,108,0,2,103,105,108,0,2,108,105,110,0,2,105,106,110,0,2,110,106,111,0,2,106,107,111,0,2,111,107,112,0,2,107,104,112,0,2,112,104,109,0,2,109,108,114,0,2,114,108,113,0,2,108,110,113,0,2,113,110,115,0,2,110,111,115,0,2,115,111,116,0,2,111,112,116,0,2,116,112,117,0,2,112,109,117,0,2,117,109,114,0,2,114,113,119,0,2,119,113,118,0,2,113,115,118,0,2,118,115,120,0,2,115,116,120,0,2,120,116,121,0,2,116,117,121,0,2,121,117,122,0,2,117,114,122,0,2,122,114,119,0,2,119,118,78,0,2,78,118,79,0,2,118,120,79,0,2,79,120,82,0,2,120,121,82,0,2,82,121,84,0,2,121,122,84,0,2,84,122,86,0,2,122,119,86,0,2,86,119,78,0,2,123,124,126,0,2,126,124,125,0,2,124,127,125,0,2,125,127,128,0,2,127,123,128,0,2,128,123,126,0,2,129,130,132,0,2,132,130,131,0,2,130,133,131,0,2,131,133,134,0,2,133,135,134,0,2,134,135,136,0,2,135,137,136,0,2,136,137,138,0,2,137,129,138,0,2,138,129,132,0,2,132,131,140,0,2,140,131,139,0,2,131,134,139,0,2,139,134,141,0,2,134,136,141,0,2,141,136,142,0,2,136,138,142,0,2,142,138,143,0,2,138,132,143,0,2,143,132,140,0,2,140,139,145,0,2,145,139,144,0,2,139,141,144,0,2,144,141,146,0,2,141,142,146,0,2,146,142,147,0,2,142,143,147,0,2,147,143,148,0,2,143,140,148,0,2,148,140,145,0,2,145,144,150,0,2,150,144,149,0,2,144,146,149,0,2,149,146,151,0,2,146,147,151,0,2,151,147,152,0,2,147,148,152,0,2,152,148,153,0,2,148,145,153,0,2,153,145,150,0,2,150,149,155,0,2,155,149,154,0,2,149,151,154,0,2,154,151,156,0,2,151,152,156,0,2,156,152,157,0,2,152,153,157,0,2,157,153,158,0,2,153,150,158,0,2,158,150,155,0,2,155,154,160,0,2,160,154,159,0,2,154,156,159,0,2,159,156,161,0,2,156,157,161,0,2,161,157,162,0,2,157,158,162,0,2,162,158,163,0,2,158,155,163,0,2,163,155,160,0,2,160,159,165,0,2,165,159,164,0,2,159,161,164,0,2,164,161,166,0,2,161,162,166,0,2,166,162,167,0,2,162,163,167,0,2,167,163,168,0,2,163,160,168,0,2,168,160,165,0,2,165,164,170,0,2,170,164,169,0,2,164,166,169,0,2,169,166,171,0,2,166,167,171,0,2,171,167,172,0,2,167,168,172,0,2,172,168,173,0,2,168,165,173,0,2,173,165,170,0,2,170,169,129,0,2,129,169,130,0,2,169,171,130,0,2,130,171,133,0,2,171,172,133,0,2,133,172,135,0,2,172,173,135,0,2,135,173,137,0,2,173,170,137,0,2,137,170,129,0,2,174,175,177,0,2,177,175,176,0,2,175,178,176,0,2,176,178,179,0,2,178,180,179,0,2,179,180,181,0,2,180,182,181,0,2,181,182,183,0,2,182,174,183,0,2,183,174,177,0,2,177,176,185,0,2,185,176,184,0,2,176,179,184,0,2,184,179,186,0,2,179,181,186,0,2,186,181,187,0,2,181,183,187,0,2,187,183,188,0,2,183,177,188,0,2,188,177,185,0,2,185,184,190,0,2,190,184,189,0,2,184,186,189,0,2,189,186,191,0,2,186,187,191,0,2,191,187,192,0,2,187,188,192,0,2,192,188,193,0,2,188,185,193,0,2,193,185,190,0,2,190,189,195,0,2,195,189,194,0,2,189,191,194,0,2,194,191,196,0,2,191,192,196,0,2,196,192,197,0,2,192,193,197,0,2,197,193,198,0,2,193,190,198,0,2,198,190,195,0,2,195,194,200,0,2,200,194,199,0,2,194,196,199,0,2,199,196,201,0,2,196,197,201,0,2,201,197,202,0,2,197,198,202,0,2,202,198,203,0,2,198,195,203,0,2,203,195,200,0,2,200,199,205,0,2,205,199,204,0,2,199,201,204,0,2,204,201,206,0,2,201,202,206,0,2,206,202,207,0,2,202,203,207,0,2,207,203,208,0,2,203,200,208,0,2,208,200,205,0,2,205,204,210,0,2,210,204,209,0,2,204,206,209,0,2,209,206,211,0,2,206,207,211,0,2,211,207,212,0,2,207,208,212,0,2,212,208,213,0,2,208,205,213,0,2,213,205,210,0,2,210,209,215,0,2,215,209,214,0,2,209,211,214,0,2,214,211,216,0,2,211,212,216,0,2,216,212,217,0,2,212,213,217,0,2,217,213,218,0,2,213,210,218,0,2,218,210,215,0,2,215,214,174,0,2,174,214,175,0,2,214,216,175,0,2,175,216,178,0,2,216,217,178,0,2,178,217,180,0,2,217,218,180,0,2,180,218,182,0,2,218,215,182,0,2,182,215,174,0,2,219,220,222,0,2,222,220,221,0,2,220,223,221,0,2,221,223,224,0,2,223,219,224,0,2,224,219,222,0,2,225,226,228,0,2,228,226,227,0,2,228,227,230,0,2,230,227,229,0,2,230,229,225,0,2,225,229,226,0,2,231,232,234,0,2,234,232,233,0,2,234,233,236,0,2,236,233,235,0,2,236,235,231,0,2,231,235,232,0,2,237,238,240,0,2,240,238,239,0,2,238,241,239,0,2,239,241,242,0,2,241,237,242,0,2,242,237,240,0,2,243,244,246,0,2,246,244,245,0,2,244,247,245,0,2,245,247,248,0,2,247,243,248,0,2,248,243,246,0,3,59,58,249,250,0,3,58,57,251,249,0,3,57,56,252,251,0,3,56,55,253,252,0,3,55,59,250,253,0],"vertices":[-0.09393824,-11.22757244,4.77897453,-4.91382265,-11.22757244,1.79473805,-3.8365593,-12.54212761,1.4865824,-0.12960286,-12.54212761,3.78178167,-3.34495711,-11.22757244,-3.03377008,-2.62992835,-12.54212761,-2.22701812,2.4444983,-11.22757244,-3.03377008,1.82270968,-12.54212761,-2.22701812,4.66662121,-11.22757244,1.79473805,3.5317843,-12.54212761,1.4865824,-0.09393824,-6.28927469,4.77897453,-4.91382265,-6.28927469,1.79473805,-3.34495711,-6.28927469,-3.03377008,2.4444983,-6.28927469,-3.03377008,4.66662121,-6.28927469,1.79473805,-0.11468434,-5.65151834,3.38062,-2.89216399,-5.65151834,1.36269069,-1.83121824,-5.65151834,-1.90254581,1.60196507,-5.65151834,-1.90254581,2.66279411,-5.65151834,1.36269069,-0.11468434,-2.68173409,3.38062,-2.89216399,-2.68173409,1.36269069,-1.83121824,-2.68173409,-1.90254581,1.60196507,-2.68173409,-1.90254581,2.66279411,-2.68173409,1.36269069,-0.11468434,-1.47533548,4.53911686,-4.26814032,-1.47533548,1.72061276,-2.51221395,-1.47533548,-2.8397162,2.28284526,-1.47533548,-2.8397162,3.97292209,-1.47533548,1.72061276,-0.11468434,2.01425743,4.53911686,-4.26814032,2.01425743,1.72061276,-2.51221395,2.01425743,-2.8397162,2.28284526,2.01425743,-2.8397162,3.97292209,2.01425743,1.72061276,-0.11468434,2.97252417,3.57479072,-3.07689214,2.97252417,1.42271352,-1.94543612,2.97252417,-2.05953693,1.71606684,2.97252417,-2.05953693,2.84752464,2.97252417,1.42271352,-0.11468434,7.4504528,2.80626678,-2.34601402,7.4504528,1.18518674,-1.49369192,7.4504528,-1.4378649,1.26432323,7.4504528,-1.4378649,2.11664629,7.4504528,1.18518674,-0.11468434,8.16839409,3.69157267,-3.18784904,8.16839409,1.45872724,-2.01396728,8.16839409,-2.15405846,1.78471422,8.16839409,-2.15405846,2.95847917,8.16839409,1.45872724,-0.11468434,11.14004326,3.69157267,-3.18784904,11.14004326,1.45872724,-2.01396728,11.14004326,-2.15405846,1.78471422,11.14004326,-2.15405846,2.95847917,11.14004326,1.45872724,-0.11468434,12.54212856,2.25114369,-1.81793129,12.54212856,1.01362658,-1.16735506,12.54212856,-0.98868507,0.93798631,12.54212856,-0.98868507,1.58856261,12.54212856,1.01362658,6.88641357,9.14647388,10.05165005,1.25989389,9.14647388,2.5906508,2.1406548,8.50953293,1.92643797,7.76717424,8.50953293,9.38755512,2.1406548,9.78329849,1.92643797,7.76717424,9.78329849,9.38755512,-6.91438532,9.14647388,10.05165005,-7.79514742,8.50953293,9.38755512,-2.16862774,8.50953293,1.92643797,-1.28786695,9.14647388,2.5906508,-7.79514742,9.78329849,9.38755512,-2.16862774,9.78329849,1.92643797,0.65115875,9.14647388,-2.09299755,-0.45197725,8.50953293,-2.09299755,-0.45197725,8.50953293,-12.32878494,0.65115875,9.14647388,-12.32878494,-0.45197725,9.78329849,-2.09299755,-0.45197725,9.78329849,-12.32878494,0.0,9.14460945,-13.66187286,0.0,10.21534348,-12.88390923,8.55469513,10.21534348,-9.77030087,9.05469036,9.14460945,-10.36621761,0.0,9.80637455,-11.62518024,7.74561214,9.80637455,-8.80597591,0.0,8.4828434,-11.62518024,7.74561214,8.4828434,-8.80597591,0.0,8.07387257,-12.88390923,8.55469513,8.07387257,-9.77030087,13.10651588,10.21534348,-1.88622904,13.87259293,9.14460945,-2.02130914,11.8669014,9.80637455,-1.66769958,11.8669014,8.4828434,-1.66769958,13.10651588,8.07387257,-1.88622904,11.52564526,10.21534348,7.07906914,12.19941521,9.14460945,7.46799278,10.43556404,9.80637455,6.44970417,10.43556404,8.4828434,6.44970417,11.52564526,8.07387257,7.07906914,4.55182028,10.21534348,12.93076038,4.81790161,9.14460945,13.66187286,4.1212883,9.80637455,11.74802208,4.1212883,8.4828434,11.74802208,4.55182028,8.07387257,12.93076038,-4.55182123,10.21534348,12.93076038,-4.81790257,9.14460945,13.66187286,-4.12128925,9.80637455,11.74802208,-4.12128925,8.4828434,11.74802208,-4.55182123,8.07387257,12.93076038,-11.52564716,10.21534348,7.07906914,-12.19929981,9.14460945,7.46799278,-10.43556404,9.80637455,6.44970417,-10.43556404,8.4828434,6.44970417,-11.52564716,8.07387257,7.07906914,-13.10639954,10.21534348,-1.88622904,-13.87259293,9.14460945,-2.02130914,-11.866786,9.80637455,-1.66769958,-11.866786,8.4828434,-1.66769958,-13.10639954,8.07387257,-1.88622904,-8.55458069,10.21534348,-9.77030087,-9.05469227,9.14460945,-10.36621761,-7.74549675,9.80637455,-8.80597591,-7.74549675,8.4828434,-8.80597591,-8.55458069,8.07387257,-9.77030087,-6.91438532,0.23956668,10.05165005,-7.79514742,-0.3973738,9.38755512,-2.16862774,-0.3973738,1.92643797,-1.28786695,0.23956668,2.5906508,-7.79514742,0.87639046,9.38755512,-2.16862774,0.87639046,1.92643797,0.0,0.33373722,-13.66187286,0.0,1.40447414,-12.88390923,8.55469513,1.40447414,-9.77030087,9.05469036,0.33373722,-10.36621761,0.0,0.99538743,-11.62518024,7.74561214,0.99538743,-8.80597591,0.0,-0.32802746,-11.62518024,7.74561214,-0.32802746,-8.80597591,0.0,-0.73699749,-12.88390923,8.55469513,-0.73699749,-9.77030087,13.10651588,1.40447414,-1.88622904,13.87259293,0.33373722,-2.02130914,11.8669014,0.99538743,-1.66769958,11.8669014,-0.32802746,-1.66769958,13.10651588,-0.73699749,-1.88622904,11.52564526,1.40447414,7.07906914,12.19941521,0.33373722,7.46799278,10.43556404,0.99538743,6.44970417,10.43556404,-0.32802746,6.44970417,11.52564526,-0.73699749,7.07906914,4.55182028,1.40447414,12.93076038,4.81790161,0.33373722,13.66187286,4.1212883,0.99538743,11.74802208,4.1212883,-0.32802746,11.74802208,4.55182028,-0.73699749,12.93076038,-4.55182123,1.40447414,12.93076038,-4.81790257,0.33373722,13.66187286,-4.12128925,0.99538743,11.74802208,-4.12128925,-0.32802746,11.74802208,-4.55182123,-0.73699749,12.93076038,-11.52564716,1.40447414,7.07906914,-12.19929981,0.33373722,7.46799278,-10.43556404,0.99538743,6.44970417,-10.43556404,-0.32802746,6.44970417,-11.52564716,-0.73699749,7.07906914,-13.10639954,1.40447414,-1.88622904,-13.87259293,0.33373722,-2.02130914,-11.866786,0.99538743,-1.66769958,-11.866786,-0.32802746,-1.66769958,-13.10639954,-0.73699749,-1.88622904,-8.55458069,1.40447414,-9.77030087,-9.05469227,0.33373722,-10.36621761,-7.74549675,0.99538743,-8.80597591,-7.74549675,-0.32802746,-8.80597591,-8.55458069,-0.73699749,-9.77030087,0.0,-8.59309864,-13.66187286,0.0,-7.52224684,-12.88390923,8.55469513,-7.52224684,-9.77030087,9.05469036,-8.59309864,-10.36621761,0.0,-7.93133354,-11.62518024,7.74561214,-7.93133354,-8.80597591,0.0,-9.25474739,-11.62518024,7.74561214,-9.25474739,-8.80597591,0.0,-9.66383457,-12.88390923,8.55469513,-9.66383457,-9.77030087,13.10651588,-7.52224684,-1.88622904,13.87259293,-8.59309864,-2.02130914,11.8669014,-7.93133354,-1.66769958,11.8669014,-9.25474739,-1.66769958,13.10651588,-9.66383457,-1.88622904,11.52564526,-7.52224684,7.07906914,12.19941521,-8.59309864,7.46799278,10.43556404,-7.93133354,6.44970417,10.43556404,-9.25474739,6.44970417,11.52564526,-9.66383457,7.07906914,4.55182028,-7.52224684,12.93076038,4.81790161,-8.59309864,13.66187286,4.1212883,-7.93133354,11.74802208,4.1212883,-9.25474739,11.74802208,4.55182028,-9.66383457,12.93076038,-4.55182123,-7.52224684,12.93076038,-4.81790257,-8.59309864,13.66187286,-4.12128925,-7.93133354,11.74802208,-4.12128925,-9.25474739,11.74802208,-4.55182123,-9.66383457,12.93076038,-11.52564716,-7.52224684,7.07906914,-12.19929981,-8.59309864,7.46799278,-10.43556404,-7.93133354,6.44970417,-10.43556404,-9.25474739,6.44970417,-11.52564716,-9.66383457,7.07906914,-13.10639954,-7.52224684,-1.88622904,-13.87259293,-8.59309864,-2.02130914,-11.866786,-7.93133354,-1.66769958,-11.866786,-9.25474739,-1.66769958,-13.10639954,-9.66383457,-1.88622904,-8.55458069,-7.52224684,-9.77030087,-9.05469227,-8.59309864,-10.36621761,-7.74549675,-7.93133354,-8.80597591,-7.74549675,-9.25474739,-8.80597591,-8.55458069,-9.66383457,-9.77030087,-6.91438532,-8.34461594,10.05165005,-7.79514742,-8.98155689,9.38755512,-2.16862774,-8.98155689,1.92643797,-1.28786695,-8.34461594,2.5906508,-7.79514742,-7.70779276,9.38755512,-2.16862774,-7.70779276,1.92643797,6.88641357,-8.34461594,10.05165005,1.25989389,-8.34461594,2.5906508,2.1406548,-8.98155689,1.92643797,7.76717424,-8.98155689,9.38755512,2.1406548,-7.70779276,1.92643797,7.76717424,-7.70779276,9.38755512,6.88641357,0.23956668,10.05165005,1.25989389,0.23956668,2.5906508,2.1406548,-0.3973738,1.92643797,7.76717424,-0.3973738,9.38755512,2.1406548,0.87639046,1.92643797,7.76717424,0.87639046,9.38755512,0.65115875,0.23956668,-2.98400402,-0.45197725,-0.3973738,-2.98400402,-0.45197725,-0.3973738,-12.32878494,0.65115875,0.23956668,-12.32878494,-0.45197725,0.87639046,-2.98400402,-0.45197725,0.87639046,-12.32878494,0.65115875,-8.34461594,-2.98400402,-0.45197725,-8.98155689,-2.98400402,-0.45197725,-8.98155689,-12.32878494,0.65115875,-8.34461594,-12.32878494,-0.45197725,-7.70779276,-2.98400402,-0.45197725,-7.70779276,-12.32878494,0.93798631,12.54212856,-0.98868507,1.58856261,12.54212856,1.01362658,-1.16735506,12.54212856,-0.98868507,-1.81793129,12.54212856,1.01362658,-0.11468434,12.54212856,2.25114369],"materials":[{"colorDiffuse":[0.4000000059604645,0.4000000059604645,0.4000000059604645],"depthWrite":true,"transparency":1.0,"blending":"NormalBlending","shading":"Lambert","DbgName":"lambert1","colorAmbient":[0.0,0.0,0.0],"transparent":false,"depthTest":true,"vertexColors":false},{"colorDiffuse":[0.4000000059604645,0.4000000059604645,0.4000000059604645],"depthWrite":true,"transparency":1.0,"blending":"NormalBlending","shading":"Lambert","DbgName":"lambert2","colorAmbient":[0.0,0.0,0.0],"transparent":false,"depthTest":true,"vertexColors":false}],"normals":[],"metadata":{"formatVersion":3.1,"generatedBy":"Maya Exporter"}}')),a.sputniks.push(n);var i=new THREE.Object3D;return a.container.add(i),i.add(n),i.rotation.x=r.x,i.rotation.y=r.y,i.rotation.z=r.z,
i.matrixAutoUpdate=!1,i.updateMatrix(),n};var PlanetContour=function(e){function t(t){var o=e.textureLoader.load(t);return o.generateMipalphaMaps=!1,o.magFilter=THREE.LinearFilter,o.minFilter=THREE.LinearFilter,o}function o(e,t){e.visible=!0;var o=e.material;o.opacity=0,TweenLite.killTweensOf(o),TweenLite.to(o,t,{opacity:a,ease:Sine.easeInOut,onComplete:function(){}})}function r(e,t){var o=e.material;TweenLite.killTweensOf(o),TweenLite.to(o,t,{opacity:0,ease:Sine.easeInOut,onComplete:function(){}})}var a=.8,n=new THREE.SphereGeometry(.995*e.radius,32,32,0,Math.PI),i=new THREE.MeshBasicMaterial;i.color=new THREE.Color(3257463),i.fog=!1,i.transparent=!0,i.blending=THREE.AdditiveBlending,i.depthWrite=!1;var s=new THREE.Mesh(n,i);s.visible=!1,s.matrixAutoUpdate=!1,s.updateMatrix(),e.container.add(s),s.matrixAutoUpdate=!1;var l=i.clone(),u=s.clone();u.material=l,e.container.add(u),u.rotation.y=Math.PI,u.updateMatrix(),this.show=function(e,r){var a=PlanetData.years[e];if(!a.contour_texture){var n=a.contour_url;a.contour_texture=[t(n[0]),t(n[1])]}i.map=a.contour_texture[0],i.map.generateMipalphaMaps=!1,i.map.magFilter=THREE.LinearFilter,i.map.minFilter=THREE.LinearFilter,i.needsUpdate=!0,l.map=a.contour_texture[1],l.map.generateMipalphaMaps=!1,l.map.magFilter=THREE.LinearFilter,l.map.minFilter=THREE.LinearFilter,l.needsUpdate=!0,o(s,r),o(u,r)},this.hide=function(e){r(s,e),r(u,e)}},PlanetData=function(){var e=this;this.textures_path="/assets/earth/",this.YEAR=null,this.YEAR_ID=null,this.years={2030:{earth_url:this.textures_path+"earth_1.png",contour_url:[this.textures_path+"contour1_1.png",this.textures_path+"contour2_1.png"],min_locations:100},2040:{earth_url:this.textures_path+"earth_1.png",contour_url:[this.textures_path+"contour1_1.png",this.textures_path+"contour2_1.png"],min_locations:50},2050:{earth_url:this.textures_path+"earth_1.png",contour_url:[this.textures_path+"contour1_1.png",this.textures_path+"contour2_1.png"],min_locations:10}},this.year_ids=[];for(var t in this.years)this.year_ids.push(t);return this.hasLocationAnyBriefs=function(t,o){if(!0===o&&t.years[e.YEAR_ID])return t.years[e.YEAR_ID].briefs;if(void 0!==o&&t.years[o])return t.years[o].briefs;for(var r in t.years){var a=t.years[r].briefs;if(a)return a}return 0},this.hasLocationAnyBriefTexts=function(t,o){if(!0===o)return t.years[e.YEAR_ID]?t.years[e.YEAR_ID].briefs_text:"";if(void 0!==o)return t.years[o].briefs_text;for(var r in t.years){if(t.years[r].briefs)return t.years[r].briefs_text}return 0},this.getWorkList=function(t,o){return!0===o?t.years[e.YEAR_ID]?t.years[e.YEAR_ID].works_list:[]:void 0!==o?t.years[o].works_list:0},this.getMoreText=function(t,o){return!0===o?t.years[e.YEAR_ID]?t.years[e.YEAR_ID].more_btn:"":void 0!==o?t.years[o].more_btn:0},this}.call({});Planet.prototype.showYear=function(e,t){function o(){var o=2.25;r.main.animateIn(o,function(){r.state=r.IDLE,r.commentToggle(!0),$(".timeline").css("pointer-events","auto")}),o=o/3*2,r.planetLocations.show(e,o),r.planetPointed.show(e,o),r.planetContour.show(e,o),t&&t(),r._PlanetCommentPopup&&r._PlanetCommentPopup.showRandom()}var r=this;if(PlanetData.YEAR_ID)return void this.hidePlanet(e,t);PlanetData.YEAR_ID=e,PlanetData.YEAR=PlanetData.years[e],PlanetData.YEAR.earth_image?o():PlanetData.YEAR.earth_image=this.projectiveImage=new ProjectiveImage(PlanetData.YEAR.earth_url,o),$(".timeline").css("pointer-events","none")},Planet.prototype.hidePlanet=function(e,t,o){this.state=this.ANIMATED;var r=this;this.deactivateHexagon(),$(".timeline").css("pointer-events","none"),r.commentToggle(!1),void 0===o&&(o=1.5),this.main.animateOut(o,function(){PlanetData.YEAR_ID=void 0,r.showYear(e,t)}),r.planetLocations.hide(o/2),r.planetPointed.hide(o/2),r.planetContour.hide(o/2),this._PlanetCommentPopup&&this._PlanetCommentPopup.hide()},THREE.Text=function(e){function t(){o.font_height=o.font_propotion*u.canvas_vis_height,a.font=o.fontStyle+" "+o.font_height+"px "+o.font,a.fillStyle=o.fillStyle,a.textBaseline="middle"}var o=this;o.offset_x=e.offset_x||0,o.border_x=e.border_x||0,o.offset_y=e.offset_y||0,o.font=e.font||"Arial",o.font_propotion=e.font_propotion||20,o.fillStyle=e.fillStyle||"rgba(255,0,0, 0.95)",o.fontStyle=e.fontStyle||"";var r=o.canvas=document.createElement("canvas"),a=o.context=r.getContext("2d");e.debug&&(document.body.appendChild(r),r.style.position="absolute",r.style.top=0,r.style.left=0);var n=new THREE.Texture(r);n.needsUpdate=!0,n.generateMipmaps=!1,n.magFilter=THREE.LinearFilter,n.minFilter=THREE.LinearFilter,n.wrapS=THREE.ClampToEdgeWrapping,n.needsUpdate=!0;var i=new THREE.MeshBasicMaterial({map:n});i.transparent=e.transparent||!1,i.side=void 0==e.side?THREE.DoubleSide:e.side,i.depthWrite=!1;var s=new THREE.PlaneGeometry(1,1),l=new THREE.Matrix4;l.setPosition(new THREE.Vector3(.5,.5,0)),s.applyMatrix(l);var u=o.mesh=new THREE.Mesh(s,i);return u.matrixAutoUpdate=!1,u.visible=!1,u.setSize=function(e,t){u.width=e,u.height=t;var o=u.canvas_vis_width=Math.floor(100*e),a=u.canvas_vis_height=Math.floor(100*t),i=Utils.nearestPow2(o),s=Utils.nearestPow2(a);r.width=i,r.height=s,n.repeat.x=u.pow_coef_x=o/i,n.repeat.y=u.pow_coef_y=a/s,n.offset.y=1-n.repeat.y,u.scale.set(e,t,1),u.updateMatrix()},u.setWidth=function(r){var n;return"string"==typeof r?(t(),n=(a.measureText(r).width+o.offset_x+o.border_x)/100):n=r,u.setSize(n,e.height),n},u.setText=function(e,i){u.setWidth(i||e),a.clearRect(0,0,r.width,r.height),u.prefill&&u.prefill.apply(o),t(),a.fillText(e,o.offset_x,u.canvas_vis_height/2),n.needsUpdate=!0},u.show=function(e){u.scale.x=.001,u.matrixAutoUpdate=!0,TweenLite.killTweensOf(u.scale),TweenLite.to(u.scale,.2,{delay:e,x:Math.floor(u.width),ease:Sine.easeOut,onStart:function(){u.visible=!0},onComplete:function(){u.updateMatrix(),u.matrixAutoUpdate=!1}})},u.hide=function(e){u.visible&&(u.scale.x=0,u.matrixAutoUpdate=!0,TweenLite.killTweensOf(u.scale),TweenLite.to(u.scale,.2,{delay:e,x:.001,ease:Sine.easeIn,onComplete:function(){u.visible=!1,u.updateMatrix(),u.matrixAutoUpdate=!1}}))},u};var Utils=new function(){this.getHalfPoint=function(e,t){var e=new THREE.Vector3(e.x,e.y,e.z),t=new THREE.Vector3(t.x,t.y,t.z);return t.sub(e).divideScalar(2).add(e)},this.getRandSides=function(e){return Math.random()*e*2-e},this.PIh=Math.PI/2,this.PI2=2*Math.PI,THREE.Vector3.ZERO=new THREE.Vector3,this.createHexagon=function(e,t,o,r){var a=r?new THREE.RingGeometry(e,e+r,32,1):new THREE.CircleGeometry(e,32);if(t){var n=new THREE.Matrix4;n.identity().makeRotationX(Math.PI/2),a.applyMatrix(n),n.identity().makeRotationY(Utils.PI2/6/2),a.applyMatrix(n)}if(!o)var o=new THREE.MeshBasicMaterial({color:16777215});o.side=THREE.BackSide;var i=new THREE.Mesh(a,o);return i.matrixAutoUpdate=!1,i},this.orientHexagon=function(e,t,o){e.position.copy(t.centerPoint),e.up.set(10*t.centerPoint.x,10*t.centerPoint.y,10*t.centerPoint.z),o&&e.lookAt(t.boundary[0])},this.nearestPow2=function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))},this.setFromSpherical=function(e,t,o,r){var a=new THREE.Spherical;return a.radius=e,a.theta=t*Math.PI*2-Math.PI/2,a.phi=o*Math.PI,r||(r=new THREE.Vector3),r.setFromSpherical(a),r}};Utils.getEventCursorPosition=function(e,t){var o,r=e.originalEvent.touches;return o=r?r.length?r[0]:e.originalEvent.changedTouches[0]:e,t?(t.x=o.clientX,void(t.y=o.clientY)):{x:o.clientX,y:o.clientY}},Utils.getEventCursorPositionOrientation=function(e,t){Util.getEventCursorPosition(e,t),t.x=t.x/window.innerWidth*2-1,t.y=-t.y/window.innerHeight*2+1},Utils.get2dPosition=function(e,t,o){var r=e.clone().project(t);return r.x=(r.x+1)/2*o.innerWidth,r.y=-(r.y-1)/2*o.innerHeight,r},Utils.drawFunction=function(e,t,o,r,a){console.log("===================================="),e=void 0==e?-Math.PI:e,t=void 0==t?Math.PI:t,r=void 0==r?.1:r,a=void 0==a?30:a,o=void 0==o?function(e){return Math.cos(e)}:o;for(var n=0,i=e;i<t;i+=r){for(var s="",l=0;l<2*a;l++)s+=l==a?":":"-";var u=o(i),d=Math.round(u*a)+a;s=s.substr(0,d)+"*"+s.substr(d+1),console.log(n+" |"+s,d),n++,n>=10&&(n=0)}console.log("====================================")};
