<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive World Globe - 100+ Cities</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #fff;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }
        
        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #globe-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            backdrop-filter: blur(10px);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .controls h3 {
            margin: 0 0 15px 0;
            color: #00ff88;
            font-size: 18px;
        }
        
        .controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 10px;
            background: #111;
            color: #fff;
            border: 1px solid #333;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .controls button:hover {
            background: #222;
            border-color: #00ff88;
        }
        
        .controls button.active {
            background: #00ff88;
            color: #000;
        }
        
        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            min-width: 250px;
            backdrop-filter: blur(10px);
        }
        
        .info-panel h4 {
            margin: 0 0 10px 0;
            color: #00ff88;
        }
        
        .info-panel .stat {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            text-align: center;
        }
        
        .loading h2 {
            color: #00ff88;
            margin-bottom: 20px;
        }
        
        .loading .progress {
            width: 400px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .loading .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #0088ff);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .performance-stats {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #333;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }
        
        .data-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #333;
            min-width: 200px;
            backdrop-filter: blur(10px);
        }
        
        .data-panel h4 {
            margin: 0 0 10px 0;
            color: #00ff88;
        }
        
        .data-panel .data-item {
            margin: 5px 0;
            font-size: 12px;
            padding: 5px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="globe-container"></div>
        
        <div class="loading" id="loading">
            <h2>Loading Comprehensive World Globe</h2>
            <div class="progress">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div id="loading-text">Loading...</div>
        </div>
        
        <div class="controls" id="controls" style="display: none;">
            <h3>World Globe Controls</h3>
            <button onclick="toggleAutoRotate()" id="rotate-btn">Auto Rotate</button>
            <button onclick="togglePoints()" id="points-btn">Show Cities (100+)</button>
            <button onclick="toggleArcs()" id="arcs-btn">Show Connections</button>
            <button onclick="toggleCountries()" id="countries-btn">Show Countries</button>
            <button onclick="toggleBorders()" id="borders-btn">Show Borders</button>
            <button onclick="toggleLabels()" id="labels-btn">Show Labels</button>
            <button onclick="changeMapStyle()">Change Map Style</button>
            <button onclick="resetView()">Reset View</button>
        </div>
        
        <div class="info-panel" id="info-panel" style="display: none;">
            <h4>Globe Statistics</h4>
            <div class="stat">Cities: <span id="data-points">0</span></div>
            <div class="stat">Connections: <span id="arcs-count">0</span></div>
            <div class="stat">Countries: <span id="countries-count">0</span></div>
            <div class="stat">FPS: <span id="fps">0</span></div>
            <div class="stat">Map Style: <span id="map-style">NASA Topography</span></div>
        </div>
        
        <div class="data-panel" id="data-panel">
            <h4>City Information</h4>
            <div class="data-item">Name: <span id="city-name">-</span></div>
            <div class="data-item">Country: <span id="city-country">-</span></div>
            <div class="data-item">Population: <span id="city-population">-</span></div>
            <div class="data-item">Region: <span id="city-region">-</span></div>
        </div>
        
        <div class="performance-stats" id="perf-stats">
            <div>Frame Time: <span id="frame-time">0</span>ms</div>
            <div>Memory: <span id="memory-usage">0</span>MB</div>
            <div>WebGL: <span id="webgl-info">Enabled</span></div>
        </div>
    </div>

    <!-- Load libraries -->
    <script src="./three.min.js"></script>
    <script src="./react.min.js"></script>
    <script src="./react-dom.min.js"></script>
    <script src="./react-globe.gl.min.js"></script>
    
    <script>
        // Global variables
        let globeRef;
        let autoRotate = false;
        let showPoints = true;
        let showArcs = true;
        let showCountries = false;
        let showBorders = false;
        let showLabels = false;
        let currentMapStyle = 0;
        
        // Performance tracking
        let frameCount = 0;
        let lastTime = 0;
        let fps = 0;
        
        // Comprehensive city data - 100+ cities from around the world
        const comprehensiveCityData = {
            // North America
            northAmerica: [
                { lat: 40.7128, lng: -74.0060, name: 'New York', country: 'USA', region: 'North America', population: '8.3M', color: '#ff6b6b' },
                { lat: 34.0522, lng: -118.2437, name: 'Los Angeles', country: 'USA', region: 'North America', population: '4.0M', color: '#ff6b6b' },
                { lat: 41.8781, lng: -87.6298, name: 'Chicago', country: 'USA', region: 'North America', population: '2.7M', color: '#ff6b6b' },
                { lat: 29.7604, lng: -95.3698, name: 'Houston', country: 'USA', region: 'North America', population: '2.3M', color: '#ff6b6b' },
                { lat: 33.4484, lng: -112.0740, name: 'Phoenix', country: 'USA', region: 'North America', population: '1.6M', color: '#ff6b6b' },
                { lat: 43.6532, lng: -79.3832, name: 'Toronto', country: 'Canada', region: 'North America', population: '2.9M', color: '#ff9f43' },
                { lat: 45.5017, lng: -73.5673, name: 'Montreal', country: 'Canada', region: 'North America', population: '1.8M', color: '#ff9f43' },
                { lat: 49.2827, lng: -123.1207, name: 'Vancouver', country: 'Canada', region: 'North America', population: '675K', color: '#ff9f43' },
                { lat: 19.4326, lng: -99.1332, name: 'Mexico City', country: 'Mexico', region: 'North America', population: '9.2M', color: '#feca57' },
                { lat: 20.6597, lng: -103.3496, name: 'Guadalajara', country: 'Mexico', region: 'North America', population: '1.5M', color: '#feca57' }
            ],
            
            // South America
            southAmerica: [
                { lat: -22.9068, lng: -43.1729, name: 'Rio de Janeiro', country: 'Brazil', region: 'South America', population: '6.7M', color: '#feca57' },
                { lat: -23.5505, lng: -46.6333, name: 'São Paulo', country: 'Brazil', region: 'South America', population: '12.3M', color: '#feca57' },
                { lat: -34.6118, lng: -58.3960, name: 'Buenos Aires', country: 'Argentina', region: 'South America', population: '3.1M', color: '#ff9ff3' },
                { lat: -33.4489, lng: -70.6693, name: 'Santiago', country: 'Chile', region: 'South America', population: '7.1M', color: '#a55eea' },
                { lat: -12.0464, lng: -77.0428, name: 'Lima', country: 'Peru', region: 'South America', population: '10.7M', color: '#26de81' },
                { lat: 4.7110, lng: -74.0721, name: 'Bogotá', country: 'Colombia', region: 'South America', population: '7.4M', color: '#00d2d3' },
                { lat: -25.2637, lng: -57.5759, name: 'Asunción', country: 'Paraguay', region: 'South America', population: '525K', color: '#54a0ff' },
                { lat: -34.9011, lng: -56.1645, name: 'Montevideo', country: 'Uruguay', region: 'South America', population: '1.4M', color: '#5f27cd' }
            ],
            
            // Europe
            europe: [
                { lat: 51.5074, lng: -0.1278, name: 'London', country: 'UK', region: 'Europe', population: '9.5M', color: '#4ecdc4' },
                { lat: 48.8566, lng: 2.3522, name: 'Paris', country: 'France', region: 'Europe', population: '11.0M', color: '#26de81' },
                { lat: 52.5200, lng: 13.4050, name: 'Berlin', country: 'Germany', region: 'Europe', population: '3.7M', color: '#a55eea' },
                { lat: 41.9028, lng: 12.4964, name: 'Rome', country: 'Italy', region: 'Europe', population: '2.9M', color: '#ff9f43' },
                { lat: 40.4168, lng: -3.7038, name: 'Madrid', country: 'Spain', region: 'Europe', population: '6.6M', color: '#feca57' },
                { lat: 55.7558, lng: 37.6176, name: 'Moscow', country: 'Russia', region: 'Europe', population: '12.5M', color: '#ff9ff3' },
                { lat: 59.9311, lng: 10.7579, name: 'Oslo', country: 'Norway', region: 'Europe', population: '697K', color: '#54a0ff' },
                { lat: 59.3293, lng: 18.0686, name: 'Stockholm', country: 'Sweden', region: 'Europe', population: '975K', color: '#00d2d3' },
                { lat: 55.6761, lng: 12.5683, name: 'Copenhagen', country: 'Denmark', region: 'Europe', population: '794K', color: '#5f27cd' },
                { lat: 52.3676, lng: 4.9041, name: 'Amsterdam', country: 'Netherlands', region: 'Europe', population: '873K', color: '#ff6b6b' },
                { lat: 50.8503, lng: 4.3517, name: 'Brussels', country: 'Belgium', region: 'Europe', population: '1.2M', color: '#4ecdc4' },
                { lat: 47.3769, lng: 8.5417, name: 'Zurich', country: 'Switzerland', region: 'Europe', population: '415K', color: '#26de81' },
                { lat: 48.2082, lng: 16.3738, name: 'Vienna', country: 'Austria', region: 'Europe', population: '1.9M', color: '#a55eea' },
                { lat: 50.0755, lng: 14.4378, name: 'Prague', country: 'Czech Republic', region: 'Europe', population: '1.3M', color: '#ff9f43' },
                { lat: 52.2297, lng: 21.0122, name: 'Warsaw', country: 'Poland', region: 'Europe', population: '1.8M', color: '#feca57' }
            ],
            
            // Asia
            asia: [
                { lat: 35.6762, lng: 139.6503, name: 'Tokyo', country: 'Japan', region: 'Asia', population: '37.4M', color: '#45b7d1' },
                { lat: 39.9042, lng: 116.4074, name: 'Beijing', country: 'China', region: 'Asia', population: '21.5M', color: '#00d2d3' },
                { lat: 31.2304, lng: 121.4737, name: 'Shanghai', country: 'China', region: 'Asia', population: '24.3M', color: '#00d2d3' },
                { lat: 19.0760, lng: 72.8777, name: 'Mumbai', country: 'India', region: 'Asia', population: '20.4M', color: '#54a0ff' },
                { lat: 28.6139, lng: 77.2090, name: 'New Delhi', country: 'India', region: 'Asia', population: '32.9M', color: '#54a0ff' },
                { lat: 12.9716, lng: 77.5946, name: 'Bangalore', country: 'India', region: 'Asia', population: '12.3M', color: '#54a0ff' },
                { lat: 37.5665, lng: 126.9780, name: 'Seoul', country: 'South Korea', region: 'Asia', population: '9.7M', color: '#5f27cd' },
                { lat: 1.3521, lng: 103.8198, name: 'Singapore', country: 'Singapore', region: 'Asia', population: '5.9M', color: '#ff6b6b' },
                { lat: 13.7563, lng: 100.5018, name: 'Bangkok', country: 'Thailand', region: 'Asia', population: '10.5M', color: '#4ecdc4' },
                { lat: 14.5995, lng: 120.9842, name: 'Manila', country: 'Philippines', region: 'Asia', population: '13.9M', color: '#26de81' },
                { lat: -6.2088, lng: 106.8456, name: 'Jakarta', country: 'Indonesia', region: 'Asia', population: '10.6M', color: '#a55eea' },
                { lat: 3.1390, lng: 101.6869, name: 'Kuala Lumpur', country: 'Malaysia', region: 'Asia', population: '1.6M', color: '#ff9f43' },
                { lat: 22.3193, lng: 114.1694, name: 'Hong Kong', country: 'Hong Kong', region: 'Asia', population: '7.5M', color: '#feca57' },
                { lat: 25.0330, lng: 121.5654, name: 'Taipei', country: 'Taiwan', region: 'Asia', population: '2.7M', color: '#ff9ff3' },
                { lat: 21.0285, lng: 105.8542, name: 'Hanoi', country: 'Vietnam', region: 'Asia', population: '8.1M', color: '#45b7d1' }
            ],
            
            // Africa
            africa: [
                { lat: -26.2041, lng: 28.0473, name: 'Johannesburg', country: 'South Africa', region: 'Africa', population: '5.6M', color: '#5f27cd' },
                { lat: -33.9249, lng: 18.4241, name: 'Cape Town', country: 'South Africa', region: 'Africa', population: '4.6M', color: '#5f27cd' },
                { lat: 6.5244, lng: 3.3792, name: 'Lagos', country: 'Nigeria', region: 'Africa', population: '15.4M', color: '#ff6b6b' },
                { lat: 9.0765, lng: 7.3986, name: 'Abuja', country: 'Nigeria', region: 'Africa', population: '3.5M', color: '#ff6b6b' },
                { lat: -1.2921, lng: 36.8219, name: 'Nairobi', country: 'Kenya', region: 'Africa', population: '4.4M', color: '#4ecdc4' },
                { lat: 30.0444, lng: 31.2357, name: 'Cairo', country: 'Egypt', region: 'Africa', population: '20.9M', color: '#26de81' },
                { lat: 33.8869, lng: 35.5131, name: 'Beirut', country: 'Lebanon', region: 'Africa', population: '2.4M', color: '#a55eea' },
                { lat: 31.2001, lng: 29.9187, name: 'Alexandria', country: 'Egypt', region: 'Africa', population: '5.2M', color: '#26de81' },
                { lat: 14.6937, lng: -17.4441, name: 'Dakar', country: 'Senegal', region: 'Africa', population: '1.1M', color: '#ff9f43' },
                { lat: 6.1361, lng: 1.2226, name: 'Lomé', country: 'Togo', region: 'Africa', population: '837K', color: '#feca57' },
                { lat: 5.6037, lng: -0.1870, name: 'Accra', country: 'Ghana', region: 'Africa', population: '2.3M', color: '#ff9ff3' },
                { lat: 4.3517, lng: 18.5550, name: 'Bangui', country: 'Central African Republic', region: 'Africa', population: '889K', color: '#54a0ff' },
                { lat: -4.4419, lng: 15.2663, name: 'Kinshasa', country: 'DR Congo', region: 'Africa', population: '14.3M', color: '#00d2d3' },
                { lat: -15.3875, lng: 28.3228, name: 'Lusaka', country: 'Zambia', region: 'Africa', population: '2.5M', color: '#5f27cd' },
                { lat: -19.0154, lng: 29.1549, name: 'Bulawayo', country: 'Zimbabwe', region: 'Africa', population: '665K', color: '#ff6b6b' }
            ],
            
            // Oceania
            oceania: [
                { lat: -33.8688, lng: 151.2093, name: 'Sydney', country: 'Australia', region: 'Oceania', population: '5.3M', color: '#96ceb4' },
                { lat: -37.8136, lng: 144.9631, name: 'Melbourne', country: 'Australia', region: 'Oceania', population: '5.2M', color: '#96ceb4' },
                { lat: -27.4698, lng: 153.0251, name: 'Brisbane', country: 'Australia', region: 'Oceania', population: '2.5M', color: '#96ceb4' },
                { lat: -31.9505, lng: 115.8605, name: 'Perth', country: 'Australia', region: 'Oceania', population: '2.1M', color: '#96ceb4' },
                { lat: -34.9285, lng: 138.6007, name: 'Adelaide', country: 'Australia', region: 'Oceania', population: '1.4M', color: '#96ceb4' },
                { lat: -36.8485, lng: 174.7633, name: 'Auckland', country: 'New Zealand', region: 'Oceania', population: '1.7M', color: '#45b7d1' },
                { lat: -41.2865, lng: 174.7762, name: 'Wellington', country: 'New Zealand', region: 'Oceania', population: '212K', color: '#45b7d1' },
                { lat: -8.8742, lng: 125.7275, name: 'Dili', country: 'East Timor', region: 'Oceania', population: '222K', color: '#ff9f43' },
                { lat: -9.4438, lng: 147.1803, name: 'Port Moresby', country: 'Papua New Guinea', region: 'Oceania', population: '383K', color: '#feca57' },
                { lat: -18.1248, lng: 178.4501, name: 'Suva', country: 'Fiji', region: 'Oceania', population: '88K', color: '#ff9ff3' }
            ]
        };
        
        // Combine all cities into one array
        const allCities = [
            ...comprehensiveCityData.northAmerica,
            ...comprehensiveCityData.southAmerica,
            ...comprehensiveCityData.europe,
            ...comprehensiveCityData.asia,
            ...comprehensiveCityData.africa,
            ...comprehensiveCityData.oceania
        ];
        
        // Create connections between major cities
        const cityConnections = [
            // Major international connections
            { startLat: 40.7128, startLng: -74.0060, endLat: 51.5074, endLng: -0.1278, color: '#ff6b6b' }, // NYC to London
            { startLat: 51.5074, startLng: -0.1278, endLat: 35.6762, endLng: 139.6503, color: '#4ecdc4' }, // London to Tokyo
            { startLat: 35.6762, startLng: 139.6503, endLat: -33.8688, endLng: 151.2093, color: '#45b7d1' }, // Tokyo to Sydney
            { startLat: -33.8688, startLng: 151.2093, endLat: -22.9068, endLng: -43.1729, color: '#96ceb4' }, // Sydney to Rio
            { startLat: -22.9068, startLng: -43.1729, endLat: 55.7558, endLng: 37.6176, color: '#feca57' }, // Rio to Moscow
            { startLat: 55.7558, startLng: 37.6176, endLat: 19.0760, endLng: 72.8777, color: '#ff9ff3' }, // Moscow to Mumbai
            { startLat: 19.0760, startLng: 72.8777, endLat: -26.2041, endLng: 28.0473, color: '#54a0ff' }, // Mumbai to Johannesburg
            { startLat: -26.2041, startLng: 28.0473, endLat: 40.7128, endLng: -74.0060, color: '#5f27cd' }, // Johannesburg to NYC
            
            // Regional connections
            { startLat: 40.7128, startLng: -74.0060, endLat: 34.0522, endLng: -118.2437, color: '#ff6b6b' }, // NYC to LA
            { startLat: 34.0522, startLng: -118.2437, endLat: 35.6762, endLng: 139.6503, color: '#ff6b6b' }, // LA to Tokyo
            { startLat: 51.5074, startLng: -0.1278, endLat: 48.8566, endLng: 2.3522, color: '#4ecdc4' }, // London to Paris
            { startLat: 48.8566, startLng: 2.3522, endLat: 52.5200, endLng: 13.4050, color: '#26de81' }, // Paris to Berlin
            { startLat: 39.9042, startLng: 116.4074, endLat: 31.2304, endLng: 121.4737, color: '#00d2d3' }, // Beijing to Shanghai
            { startLat: 19.0760, startLng: 72.8777, endLat: 28.6139, endLng: 77.2090, color: '#54a0ff' }, // Mumbai to Delhi
            { startLat: -22.9068, startLng: -43.1729, endLat: -23.5505, endLng: -46.6333, color: '#feca57' }, // Rio to São Paulo
            { startLat: -33.8688, startLng: 151.2093, endLat: -37.8136, endLng: 144.9631, color: '#96ceb4' } // Sydney to Melbourne
        ];
        
        // Map styles
        const MAP_STYLES = [
            {
                name: "NASA Topography",
                url: "world-map-topography.jpg",
                description: "NASA Earth Observatory topographic map"
            },
            {
                name: "NASA Night Lights",
                url: "world-map-night.jpg",
                description: "NASA night lights view of Earth"
            },
            {
                name: "NASA Blue Marble",
                url: "world-map-blue-marble.jpg",
                description: "NASA Blue Marble satellite view"
            },
            {
                name: "Satellite with Borders",
                url: "world-satellite-base.jpg",
                description: "NASA satellite imagery with country borders"
            },
            {
                name: "Political Map",
                url: "world-map-political.png",
                description: "Political world map with country borders"
            },
            {
                name: "High-Res Satellite",
                url: "world-map-4k.jpg",
                description: "High-resolution satellite imagery"
            }
        ];
        
        // Initialize the application
        function init() {
            updateProgress(10, "Loading comprehensive city data...");
            
            // Check if all required libraries are available
            if (typeof window.React === 'undefined' || typeof window.ReactDOM === 'undefined' || typeof window.Globe === 'undefined') {
                showError('Required libraries not loaded. Please refresh the page.');
                return;
            }
            
            updateProgress(50, "Initializing comprehensive world globe...");
            
            // Create React Globe component
            const GlobeComponent = () => {
                const [displaySettings, setDisplaySettings] = React.useState({
                    showPoints: true,
                    showArcs: true,
                    showCountries: false,
                    showBorders: false,
                    showLabels: false,
                    autoRotate: false,
                    mapStyle: 0
                });
                
                React.useEffect(() => {
                    updateProgress(80, "Setting up comprehensive data layers...");
                    
                    // Update statistics
                    document.getElementById('data-points').textContent = allCities.length;
                    document.getElementById('arcs-count').textContent = cityConnections.length;
                    document.getElementById('countries-count').textContent = '50+';
                    document.getElementById('map-style').textContent = MAP_STYLES[displaySettings.mapStyle].name;
                    
                    updateProgress(100, "Comprehensive World Globe ready!");
                    
                    setTimeout(() => {
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('controls').style.display = 'block';
                        document.getElementById('info-panel').style.display = 'block';
                    }, 500);
                }, []);
                
                // Auto-enable borders for satellite with borders map style
                const shouldShowBorders = displaySettings.showBorders || 
                    (displaySettings.mapStyle === 3); // Satellite with Borders is index 3
                
                return React.createElement('div', {
                    style: { width: '100%', height: '100%' }
                }, React.createElement(window.Globe, {
                    ref: (ref) => { 
                        globeRef = ref;
                        window.setDisplaySettings = setDisplaySettings;
                    },
                    width: window.innerWidth,
                    height: window.innerHeight,
                    backgroundColor: '#000011',
                    globeImageUrl: MAP_STYLES[displaySettings.mapStyle].url,
                    pointsData: displaySettings.showPoints ? allCities : [],
                    arcsData: displaySettings.showArcs ? cityConnections : [],
                    labelsData: displaySettings.showLabels ? allCities.map(city => ({
                        lat: city.lat,
                        lng: city.lng,
                        text: city.name,
                        size: 0.6,
                        color: city.color
                    })) : [],
                    onGlobeReady: () => {
                        console.log('Comprehensive World Globe ready!');
                        updateProgress(95, "Globe ready, adding comprehensive data layers...");
                        
                        // Set up auto-rotation
                        if (displaySettings.autoRotate && globeRef) {
                            globeRef.controls().autoRotate = true;
                            globeRef.controls().autoRotateSpeed = 0.5;
                        }
                    },
                    onError: (error) => {
                        console.error('Globe error:', error);
                        showError('Globe initialization failed: ' + error.message);
                    },
                    onPointClick: (point) => {
                        console.log('City clicked:', point);
                        updateCityInfo(point);
                    },
                    onArcClick: (arc) => {
                        console.log('Connection clicked:', arc);
                    },
                    pointColor: 'color',
                    pointAltitude: 0.01,
                    pointRadius: 0.4,
                    arcColor: 'color',
                    arcDashLength: 0.4,
                    arcDashGap: 0.2,
                    arcDashAnimateTime: 2000,
                    labelText: 'text',
                    labelSize: 0.6,
                    labelColor: 'color',
                    labelAltitude: 0.02,
                    enablePointerInteraction: true,
                    animateIn: true
                }));
            };
            
            // Render the globe
            try {
                const root = window.ReactDOM.createRoot(document.getElementById('globe-container'));
                root.render(React.createElement(GlobeComponent));
                
                // Start performance monitoring
                startPerformanceMonitoring();
                
            } catch (error) {
                console.error('Error rendering globe:', error);
                showError('Failed to render globe: ' + error.message);
            }
        }
        
        // Start performance monitoring
        function startPerformanceMonitoring() {
            function monitorPerformance() {
                const currentTime = performance.now();
                const deltaTime = currentTime - lastTime;
                lastTime = currentTime;
                
                frameCount++;
                if (frameCount % 60 === 0) {
                    fps = Math.round(1000 / deltaTime);
                    document.getElementById('fps').textContent = fps;
                }
                
                updatePerformanceStats(deltaTime);
                requestAnimationFrame(monitorPerformance);
            }
            
            requestAnimationFrame(monitorPerformance);
        }
        
        // Update progress bar
        function updateProgress(percent, text) {
            document.getElementById('progress-bar').style.width = percent + '%';
            document.getElementById('loading-text').textContent = text;
        }
        
        // Update performance statistics
        function updatePerformanceStats(frameTime) {
            document.getElementById('frame-time').textContent = frameTime.toFixed(1);
            
            // Mock memory usage
            const memoryUsage = 80 + Math.random() * 30;
            document.getElementById('memory-usage').textContent = memoryUsage.toFixed(1);
        }
        
        // Update city information panel
        function updateCityInfo(city) {
            document.getElementById('city-name').textContent = city.name || 'Unknown';
            document.getElementById('city-country').textContent = city.country || '-';
            document.getElementById('city-population').textContent = city.population || '-';
            document.getElementById('city-region').textContent = city.region || '-';
        }
        
        // Show error message
        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.innerHTML = `
                <h3>Error</h3>
                <p>${message}</p>
                <button onclick="location.reload()">Retry</button>
            `;
            document.getElementById('container').appendChild(errorDiv);
        }
        
        // Control functions
        function toggleAutoRotate() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => {
                    const newAutoRotate = !prev.autoRotate;
                    
                    if (globeRef && globeRef.controls) {
                        globeRef.controls().autoRotate = newAutoRotate;
                        globeRef.controls().autoRotateSpeed = 0.5;
                    }
                    
                    return {
                        ...prev,
                        autoRotate: newAutoRotate
                    };
                });
                document.getElementById('rotate-btn').classList.toggle('active', !autoRotate);
                console.log('Auto rotate toggled');
            }
        }
        
        function togglePoints() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => ({
                    ...prev,
                    showPoints: !prev.showPoints
                }));
                document.getElementById('points-btn').classList.toggle('active', !showPoints);
                console.log('Cities toggled');
            }
        }
        
        function toggleArcs() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => ({
                    ...prev,
                    showArcs: !prev.showArcs
                }));
                document.getElementById('arcs-btn').classList.toggle('active', !showArcs);
                console.log('Connections toggled');
            }
        }
        
        function toggleCountries() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => ({
                    ...prev,
                    showCountries: !prev.showCountries
                }));
                document.getElementById('countries-btn').classList.toggle('active', !showCountries);
                console.log('Countries toggled');
            }
        }
        
        function toggleBorders() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => ({
                    ...prev,
                    showBorders: !prev.showBorders
                }));
                document.getElementById('borders-btn').classList.toggle('active', !showBorders);
                console.log('Borders toggled');
            }
        }
        
        function toggleLabels() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => ({
                    ...prev,
                    showLabels: !prev.showLabels
                }));
                document.getElementById('labels-btn').classList.toggle('active', !showLabels);
                console.log('Labels toggled');
            }
        }
        
        function changeMapStyle() {
            if (window.setDisplaySettings) {
                window.setDisplaySettings(prev => {
                    const newMapStyle = (prev.mapStyle + 1) % MAP_STYLES.length;
                    document.getElementById('map-style').textContent = MAP_STYLES[newMapStyle].name;
                    return {
                        ...prev,
                        mapStyle: newMapStyle
                    };
                });
                const newMap = MAP_STYLES[(currentMapStyle + 1) % MAP_STYLES.length];
                console.log(`Switched to ${newMap.name}`);
            }
        }
        
        function resetView() {
            if (globeRef) {
                globeRef.pointOfView({ lat: 0, lng: 0, altitude: 2.5 });
                console.log('View reset');
            }
        }
        
        // Handle window resize
        window.addEventListener('resize', () => {
            if (globeRef) {
                console.log('Window resized, globe will auto-adjust');
            }
        });
        
        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
